{"remainingRequest":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/thread-loader/dist/cjs.js!/Users/liangma/Desktop/workspace/BaseMap/node_modules/babel-loader/lib/index.js!/Users/liangma/Desktop/workspace/BaseMap/node_modules/eslint-loader/index.js??ref--13-0!/Users/liangma/Desktop/workspace/BaseMap/src/components/editor/editor.vue.js?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangma/Desktop/workspace/BaseMap/src/components/editor/editor.vue.js","mtime":1592142803607},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBFZGl0b3JDb21wcyBmcm9tICcuLy4uLy4uL2NvbXBvbmVudHMvY29tcHMvZWRpdG9yLWNvbXBzJzsKaW1wb3J0IEVkaXRvckNhbnZhcyBmcm9tICcuLy4uLy4uL2NvbXBvbmVudHMvY2FudmFzL2VkaXRvci1jYW52YXMnOwppbXBvcnQgRWRpdG9yU2V0dGluZ3MgZnJvbSAnLi8uLi8uLi9jb21wb25lbnRzL3NldHRpbmdzL2VkaXRvci1zZXR0aW5ncyc7CmltcG9ydCBFZGl0b3JIZWxwIGZyb20gJy4vLi4vLi4vY29tcG9uZW50cy9oZWxwL2VkaXRvci1oZWxwJzsKaW1wb3J0IEVkaXRvckhpc3RvcnkgZnJvbSAnLi8uLi8uLi9jb21wb25lbnRzL2hpc3RvcnkvZWRpdG9yLWhpc3RvcnknOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0VkaXRvcicsCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5pdFN0b3JhZ2VEYXRhKCk7CiAgICB0aGlzLmluaXRCaW5kaW5nRXZlbnQoKTsKICAgIHRoaXMuaW5pdERhdGE7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkge30sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVTdGF0ZXM6IHsKICAgICAgICBjdXJyZW50QWN0aXZlSW5kZXg6IC0xLAogICAgICAgIGNvcHlCeUtleUJvb2w6IGZhbHNlLAogICAgICAgIG11bHRpcGxlQWN0aXZlQXJyOiBbXQogICAgICB9LAogICAgICBlZHJhd0NvbXBvbmVudHM6IFtdLAogICAgICBjb25maWdzOiB7CiAgICAgICAgYmc6ICJncmlkIiwKICAgICAgICBwYWdlTmFtZTogJ+W6leWbvicsCiAgICAgICAgc3BhY2luZzogMTAsCiAgICAgICAgc2NhbGU6IDEsCiAgICAgICAgZHJhZ0ljb25TaXplOiAyLAogICAgICAgIElzb21ldHJpY19yb3c6IDEwLAogICAgICAgIElzb21ldHJpY19jb2x1OiAxMCwKICAgICAgICBkb3dsb2FkSW1nVHlwZTogJ3BuZycsCiAgICAgICAgYmdBbGxCb29sOiBmYWxzZSwKICAgICAgICB3aWR0aDogMjk0NSwKICAgICAgICBoZWlnaHQ6IDE0NDUsCiAgICAgICAgbWF4V2lkdGg6IDM0NDUsCiAgICAgICAgbWF4SGllZ2h0OiAxNTA1LAogICAgICAgIGJhY2tncm91bmRVcmw6ICIiCiAgICAgIH0sCiAgICAgIHdlYkNvbmZpZzogewogICAgICAgIGN1c3RvbTogMjUsCiAgICAgICAgYXV0bzogNQogICAgICB9LAogICAgICBoaXN0b3J5Q3Vycm5ldERhdGE6IFtdLAogICAgICBjdXJyZW50SGlzdG9yeUluZGV4OiAtMSwKICAgICAgYWN0aXZlSGlzdG9yeUJvb2w6IGZhbHNlCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgJ2VkaXRvci1jb21wcyc6IEVkaXRvckNvbXBzLAogICAgJ2VkaXRvci1jYW52YXMnOiBFZGl0b3JDYW52YXMsCiAgICAnZWRpdG9yLXNldHRpbmdzJzogRWRpdG9yU2V0dGluZ3MsCiAgICAnZWRpdG9yLWhlbHAnOiBFZGl0b3JIZWxwLAogICAgJ2VkaXRvci1oaXN0b3J5JzogRWRpdG9ySGlzdG9yeQogIH0sCiAgbWV0aG9kczogewogICAgaW5pdERhdGE6IGZ1bmN0aW9uIGluaXREYXRhKCkgewogICAgICB0aGlzLmFjdGl2ZUhpc3RvcnlCb29sID0gZmFsc2U7CiAgICB9LAogICAgaW5pdEJpbmRpbmdFdmVudDogZnVuY3Rpb24gaW5pdEJpbmRpbmdFdmVudCgpIHsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2F5ZG93bkZ1biwgZmFsc2UpOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm1vdXNlZG93bkZ1bik7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLmxlYXZpbmcpOwogICAgfSwKICAgIGxlYXZpbmc6IGZ1bmN0aW9uIGxlYXZpbmcoZXZlbnQpIHsKICAgICAgLy8gdGhpcy5zYXZlRGF0ZVRvU3RvcmFnZSgpOwogICAgICAvLyBjb25zb2xlLmxvZyhldmVudC5yZXR1cm5WYWx1ZSkKICAgICAgdmFyIG1lc3NhZ2UgPSAi5YaF5a655pu05pS577yM5rOo5oSP5oiq5Zu+57yT5a2YIjsKICAgICAgZXZlbnQucmV0dXJuVmFsdWUgPSBtZXNzYWdlOwogICAgICByZXR1cm4gbWVzc2FnZTsKICAgIH0sCiAgICBkb3dubG9hZDogZnVuY3Rpb24gZG93bmxvYWQoKSB7Ly9UT0RPOumhtemdouS4i+i9vQogICAgfSwKICAgIHNhdmVBczogZnVuY3Rpb24gc2F2ZUFzKGltZykgewogICAgICB2YXIgX2RvbSA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CgogICAgICBfZG9tLmhyZWYgPSBpbWc7CiAgICAgIF9kb20uZGF0YXNldC5kb3dubG9hZHVybCA9IFsnaW1hZ2UvcG5nJywgJ0lNR19ET1dOTE9BRF9OQU1FJywgX2RvbS5ocmVmXS5qb2luKCc6Jyk7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoX2RvbSk7CgogICAgICBfZG9tLmNsaWNrKCk7CgogICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKF9kb20pOwogICAgfSwKICAgIC8vIOe7hOS7tumAieaLqQogICAgc2VsZWN0Q29tcDogZnVuY3Rpb24gc2VsZWN0Q29tcChldmVudCwgY29tcCkgewogICAgICB2YXIgaXRlbSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29tcCkpOwogICAgICBpZiAoIWl0ZW0pIHJldHVybjsKICAgICAgdGhpcy5pbml0Q29tcFN0YXRlKCk7CiAgICAgIGl0ZW0uaXNBY3RpdmUgPSB0cnVlOwogICAgICBpdGVtLm11bHRpcGxlQWN0aXZlQm9vbCA9IGZhbHNlOwogICAgICB2YXIgcmVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5nZXRDbGllbnRSZWN0cygpWzBdOwogICAgICB2YXIgX2l0ZW0kZGVmU3R5bGUgPSBpdGVtLmRlZlN0eWxlLAogICAgICAgICAgd2lkdGggPSBfaXRlbSRkZWZTdHlsZS53aWR0aCwKICAgICAgICAgIGhlaWdodCA9IF9pdGVtJGRlZlN0eWxlLmhlaWdodCwKICAgICAgICAgIGJvcmRlclJhZGl1cyA9IF9pdGVtJGRlZlN0eWxlLmJvcmRlclJhZGl1cywKICAgICAgICAgIHJvdGF0ZSA9IF9pdGVtJGRlZlN0eWxlLnJvdGF0ZSwKICAgICAgICAgIGJvcmRlcldpZHRoID0gX2l0ZW0kZGVmU3R5bGUuYm9yZGVyV2lkdGgsCiAgICAgICAgICBiYWNrZ3JvdW5kID0gX2l0ZW0kZGVmU3R5bGUuYmFja2dyb3VuZCwKICAgICAgICAgIGlzQXBwbHlTaGFkb3cgPSBfaXRlbSRkZWZTdHlsZS5pc0FwcGx5U2hhZG93LAogICAgICAgICAgYmdpQm9vbCA9IF9pdGVtJGRlZlN0eWxlLmJnaUJvb2wsCiAgICAgICAgICBjb2xvciA9IF9pdGVtJGRlZlN0eWxlLmNvbG9yLAogICAgICAgICAgYm9yZGVyID0gX2l0ZW0kZGVmU3R5bGUuYm9yZGVyLAogICAgICAgICAgb3BhY2l0eSA9IF9pdGVtJGRlZlN0eWxlLm9wYWNpdHk7CiAgICAgIHZhciBjbGllbnRYID0gZXZlbnQuY2xpZW50WCwKICAgICAgICAgIGNsaWVudFkgPSBldmVudC5jbGllbnRZOwogICAgICB2YXIgX3N0eWxlID0gewogICAgICAgIHdpZHRoOiB3aWR0aCB8fCAxMDAsCiAgICAgICAgaGVpZ2h0OiBoZWlnaHQgfHwgMTAwLAogICAgICAgIHRvcDogKGNsaWVudFkgLSByZWN0LnRvcCArIDYwIHx8IDEwMCkgLyB0aGlzLmNvbmZpZ3Muc2NhbGUsCiAgICAgICAgbGVmdDogKGNsaWVudFggKyAyMTMgLSByZWN0LmxlZnQgfHwgMTAwKSAvIHRoaXMuY29uZmlncy5zY2FsZSwKICAgICAgICByb3RhdGU6IHJvdGF0ZSB8fCAwLAogICAgICAgIGRyYWdfc3RhcnRfeDogMCwKICAgICAgICAvL+aLluaLveebuOWvuQogICAgICAgIGRyYWdfc3RhcnRfeTogMCwKICAgICAgICBib3JkZXJXaWR0aDogYm9yZGVyV2lkdGggfHwgMCwKICAgICAgICBiYWNrZ3JvdW5kOiBiYWNrZ3JvdW5kLAogICAgICAgIGlzQXBwbHlTaGFkb3c6IGlzQXBwbHlTaGFkb3cgPT09IHVuZGVmaW5lZCB8fCBpc0FwcGx5U2hhZG93ID09PSBudWxsID8gJ3RydWUnIDogJ2ZhbHNlJywKICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJywKICAgICAgICBpc0ZpeGVkOiAiZmFsc2UiLAogICAgICAgIGJnaUJvb2w6IGJnaUJvb2wgfHwgZmFsc2UsCiAgICAgICAgLy/mnZDotKgKICAgICAgICBib3JkZXJSYWRpdXM6IGJvcmRlclJhZGl1cyB8fCAwLAogICAgICAgIGJvcmRlcjogYm9yZGVyLAogICAgICAgIGZvbnRTaXplOiAxNCwKICAgICAgICBvcGFjaXR5OiBvcGFjaXR5LAogICAgICAgIGNvbG9yOiBjb2xvcgogICAgICB9OwogICAgICBfc3R5bGUubGVmdCA9IE1hdGgubWF4KDAsIE1hdGgubWluKF9zdHlsZS5sZWZ0LCB0aGlzLmNvbmZpZ3MubWF4V2lkdGgpKTsKICAgICAgX3N0eWxlLnRvcCA9IE1hdGgubWF4KDAsIE1hdGgubWluKF9zdHlsZS50b3AsIHRoaXMuY29uZmlncy5tYXhIaWVnaHQpKTsKICAgICAgaXRlbS5zdHlsZSA9IF9zdHlsZTsKICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHMucHVzaChpdGVtKTsKICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IHRoaXMuZWRyYXdDb21wb25lbnRzLmxlbmd0aCAtIDE7CiAgICB9LAogICAgaW5pdENvbXBvbmVudFN0YXRlOiBmdW5jdGlvbiBpbml0Q29tcG9uZW50U3RhdGUoY3VycmVudCwgZXZlbnQpIHsKICAgICAgaWYgKGN1cnJlbnQgPT09IHVuZGVmaW5lZCB8fCBjdXJyZW50ID09PSBudWxsIHx8IGN1cnJlbnQgPT09IC0xKSByZXR1cm47CgogICAgICBpZiAoZXZlbnQgJiYgKGV2ZW50LnNoaWZ0S2V5IHx8IGV2ZW50Lm1ldGFLZXkgJiYgdGhpcy5pc01hYygpKSAmJiBldmVudC5idXR0b24gPT09IDApIHsKICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XS5pc0FjdGl2ZSA9IGZhbHNlOwoKICAgICAgICBpZiAodGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA+IC0xKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gLTE7CiAgICAgICAgfSAvLyDlpJrpgInmk43kvZznvJPlrZjmlbDnu4QKCgogICAgICAgIHZhciBfbXVsdGlwQWN0aXZlSW5kZXggPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIuaW5kZXhPZih0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XSk7CgogICAgICAgIGlmIChfbXVsdGlwQWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIucHVzaCh0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0ubXVsdGlwbGVBY3RpdmVCb29sKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XS5tdWx0aXBsZUFjdGl2ZUJvb2wgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zcGxpY2UoX211bHRpcEFjdGl2ZUluZGV4LCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0ubXVsdGlwbGVBY3RpdmVCb29sID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pbml0Q29tcFN0YXRlKCk7CiAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IGN1cnJlbnQ7CiAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0uaXNBY3RpdmUgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgLy8g5Yid5aeL5YyW55S75biD5YaF57uE5Lu254q25oCBCiAgICBpbml0Q29tcFN0YXRlOiBmdW5jdGlvbiBpbml0Q29tcFN0YXRlKCkgewogICAgICB2YXIgbGVuID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tpXS5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLm11bHRpcGxlQWN0aXZlQm9vbCA9IGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLmVTdGF0ZXMuY29weUJ5S2V5Qm9vbCA9IGZhbHNlOwogICAgfSwKICAgIC8vIOe7hOS7tuaLluaLve+8mnNoaWZ0S2V5ID09PSB0cnVlIOWkhOeQhuWkmumAiQogICAgZHJhZ0N1cnJlbnRDb21wOiBmdW5jdGlvbiBkcmFnQ3VycmVudENvbXAoZXZlbnQsIGNvbXAsIHN0YXRlLCBjdXJyZW50SW5kZXgpIHsKICAgICAgaWYgKGV2ZW50ICYmIChldmVudC5zaGlmdEtleSB8fCBldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkpIHsKICAgICAgICBjb25zb2xlLmxvZygn5aSa6YCJ5aSE55CGJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wgPSBmYWxzZTsKICAgICAgICB2YXIgX3JlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJykuZ2V0Q2xpZW50UmVjdHMoKVswXTsKICAgICAgICB2YXIgX2wgPSBfcmVjdC5sZWZ0OwogICAgICAgIHZhciBfdCA9IF9yZWN0LmxlZnQ7CgogICAgICAgIGlmIChzdGF0ZSA9PT0gJ3N0YXJ0JykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IGN1cnJlbnRJbmRleDsKICAgICAgICAgIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94ID0gKGV2ZW50LmNsaWVudFggLSBfbCkgLyB0aGlzLmNvbmZpZ3Muc2NhbGUgLSBjb21wLnN0eWxlLmxlZnQgKyAyMTM7CiAgICAgICAgICBjb21wLnN0eWxlLmRyYWdfc3RhcnRfeSA9IChldmVudC5jbGllbnRZIC0gX3QpIC8gdGhpcy5jb25maWdzLnNjYWxlIC0gY29tcC5zdHlsZS50b3AgKyA2MDsKICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAnZHJhZycpIHsKICAgICAgICAgIHZhciBfbGVmdCA9IChldmVudC5jbGllbnRYIC0gX2wpIC8gdGhpcy5jb25maWdzLnNjYWxlIC0gY29tcC5zdHlsZS5kcmFnX3N0YXJ0X3ggKyAyMTM7CgogICAgICAgICAgdmFyIF90b3AgPSAoZXZlbnQuY2xpZW50WSAtIF90KSAvIHRoaXMuY29uZmlncy5zY2FsZSAtIGNvbXAuc3R5bGUuZHJhZ19zdGFydF95ICsgNjA7CgogICAgICAgICAgaWYgKF9sZWZ0IDwgMCB8fCBfdG9wIDwgMCkgcmV0dXJuOwogICAgICAgICAgX2xlZnQgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihfbGVmdCwgdGhpcy5jb25maWdzLm1heFdpZHRoKSk7CiAgICAgICAgICBfdG9wID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oX3RvcCwgdGhpcy5jb25maWdzLm1heEhpZWdodCkpOwogICAgICAgICAgY29tcC5zdHlsZS5sZWZ0ID0gX2xlZnQ7CiAgICAgICAgICBjb21wLnN0eWxlLnRvcCA9IF90b3A7CiAgICAgICAgfQoKICAgICAgICBpZiAoWydzdGFydCcsICdkcmFnJ10uaW5kZXhPZihzdGF0ZSkgPiAtMSkgewogICAgICAgICAgdGhpcy5lbGltaW5hdGVHaG9zdGluZyhldmVudCk7IC8vIOa2iOmZpOaLluaLvemsvOW9sQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHJlc2l6ZUJ5RHJhZ0NvbXA6IGZ1bmN0aW9uIHJlc2l6ZUJ5RHJhZ0NvbXAoZXZlbnQsIGNvbXAsIHN0YXRlLCBhcnJvdywgY3VycmVudEluZGV4KSB7CiAgICAgIGlmIChldmVudCAmJiAoZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQubWV0YUtleSAmJiB0aGlzLmlzTWFjKCkpKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+WkmumAieWkhOeQhicpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZVN0YXRlcy5jb3B5QnlLZXlCb29sID0gZmFsc2U7CiAgICAgICAgdmFyIF9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpLmdldENsaWVudFJlY3RzKClbMF0ubGVmdDsKICAgICAgICB2YXIgX3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJykuZ2V0Q2xpZW50UmVjdHMoKVswXS50b3A7CgogICAgICAgIGlmIChzdGF0ZSA9PT0gJ3N0YXJ0JykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IGN1cnJlbnRJbmRleDsKICAgICAgICAgIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94ID0gYXJyb3cgPT09ICdyJyA/IGNvbXAuc3R5bGUubGVmdCA6IGFycm93ID09PSAnbCcgPyBjb21wLnN0eWxlLmxlZnQgKyBjb21wLnN0eWxlLndpZHRoIDogMTA7CiAgICAgICAgICBjb21wLnN0eWxlLmRyYWdfc3RhcnRfeSA9IGFycm93ID09PSAnYicgPyBjb21wLnN0eWxlLnRvcCA6IGFycm93ID09PSAndCcgPyBjb21wLnN0eWxlLnRvcCArIGNvbXAuc3R5bGUuaGVpZ2h0IDogMTA7CiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2RyYWcnKSB7CiAgICAgICAgICB2YXIgX3dpZHRoID0gMDsKICAgICAgICAgIHZhciBfdG9wID0gMDsKICAgICAgICAgIHZhciBfaGVpZ2h0ID0gMDsKCiAgICAgICAgICBzd2l0Y2ggKGFycm93KSB7CiAgICAgICAgICAgIGNhc2UgJ3InOgogICAgICAgICAgICAgIF93aWR0aCA9IHBhcnNlSW50KChldmVudC5jbGllbnRYIC0gX2wpIC8gdGhpcy5jb25maWdzLnNjYWxlKSAtIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94ICsgMjEzOwogICAgICAgICAgICAgIGNvbXAuc3R5bGUud2lkdGggPSBNYXRoLm1heChNYXRoLm1pbihfd2lkdGgsIHRoaXMuY29uZmlncy53aWR0aCksIDEwKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgJ2InOgogICAgICAgICAgICAgIF90b3AgPSBwYXJzZUludCgoZXZlbnQuY2xpZW50WSAtIF90KSAvIHRoaXMuY29uZmlncy5zY2FsZSkgLSBjb21wLnN0eWxlLmRyYWdfc3RhcnRfeSArIDYwOwogICAgICAgICAgICAgIGNvbXAuc3R5bGUuaGVpZ2h0ID0gTWF0aC5tYXgoTWF0aC5taW4oX3RvcCwgdGhpcy5jb25maWdzLm1heFdpZHRoKSwgMTApOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAnbCc6CiAgICAgICAgICAgICAgY29tcC5zdHlsZS5sZWZ0ID0gcGFyc2VJbnQoKGV2ZW50LmNsaWVudFggLSBfbCkgLyB0aGlzLmNvbmZpZ3Muc2NhbGUgKyAyMTMpOwogICAgICAgICAgICAgIF93aWR0aCA9IHBhcnNlSW50KGNvbXAuc3R5bGUuZHJhZ19zdGFydF94IC0gY29tcC5zdHlsZS5sZWZ0KTsKICAgICAgICAgICAgICBfd2lkdGggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihfd2lkdGgsIHRoaXMuY29uZmlncy5tYXhXaWR0aCkpOwogICAgICAgICAgICAgIGNvbXAuc3R5bGUud2lkdGggPSBNYXRoLm1heChfd2lkdGgsIDEwKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgJ3QnOgogICAgICAgICAgICAgIGNvbXAuc3R5bGUudG9wID0gKGV2ZW50LmNsaWVudFkgLSBfdCkgLyB0aGlzLmNvbmZpZ3Muc2NhbGUgKyA2MDsKICAgICAgICAgICAgICBfaGVpZ2h0ID0gcGFyc2VJbnQoY29tcC5zdHlsZS5kcmFnX3N0YXJ0X3kgLSBjb21wLnN0eWxlLnRvcCk7CiAgICAgICAgICAgICAgX2hlaWdodCA9IE1hdGgubWF4KDEwLCBNYXRoLm1pbihfaGVpZ2h0LCB0aGlzLmNvbmZpZ3MubWF4V2lkdGgpKTsKICAgICAgICAgICAgICBjb21wLnN0eWxlLmhlaWdodCA9IE1hdGgubWF4KF9oZWlnaHQsIDEwKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdHJhbnNDb21wOiBmdW5jdGlvbiB0cmFuc0NvbXAoZXZlbnQsIGNvbXApIHsKICAgICAgdmFyIF94ID0gZXZlbnQuY2xpZW50WCAtIGNvbXAuc3R5bGUubGVmdCAtIGNvbXAuc3R5bGUud2lkdGggLyAyOwoKICAgICAgdmFyIF95ID0gZXZlbnQuY2xpZW50WSAtIGNvbXAuc3R5bGUudG9wIC0gY29tcC5zdHlsZS5oZWlnaHQgLyAyOwoKICAgICAgY29tcC5zdHlsZS5yb3RhdGUgPSB0aGlzLmNhbGNBbmdsZURlZ3JlZXMoX3gsIF95KTsKICAgIH0sCiAgICBjaGFuZ2VUZXh0VmFsOiBmdW5jdGlvbiBjaGFuZ2VUZXh0VmFsKGV2ZW50LCBpdGVtKSB7CiAgICAgIHZhciB2YWwgPSBldmVudC50YXJnZXQuaW5uZXJUZXh0OwoKICAgICAgaWYgKGV2ZW50ICYmIGl0ZW0pIHsKICAgICAgICBpdGVtLnZhbHVlID0gdmFsOwogICAgICAgIGV2ZW50LnRhcmdldC5pbm5lclRleHQgPSBpdGVtLnZhbHVlOwogICAgICB9CiAgICB9LAogICAgLy8g57uE5Lu25Yig6ZmkCiAgICBkZWxDb21wOiBmdW5jdGlvbiBkZWxDb21wKGluZGV4LCBzdGF0ZSkgewogICAgICBpZiAoc3RhdGUgPT09ICdtdWx0aXBsZURlbCcpIHsKICAgICAgICB2YXIgbGVuID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwoKICAgICAgICBmb3IgKHZhciBpID0gbGVuOyBpLS07IGkgPiAwKSB7CiAgICAgICAgICB2YXIgbXVsdGlwQm9vbCA9IHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLm11bHRpcGxlQWN0aXZlQm9vbDsKCiAgICAgICAgICBpZiAobXVsdGlwQm9vbCkgewogICAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID4gLTEgJiYgdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHMuc3BsaWNlKHRoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXgsIDEpOwogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IC0xOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOmUruebmOS6i+S7tgogICAga2F5ZG93bkZ1bjogZnVuY3Rpb24ga2F5ZG93bkZ1bihldmVudCkgewogICAgICBpZiAoZXZlbnQua2V5ID09PSAndicgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ub2RlTmFtZSA9PT0gJ0lOUFVUJykgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09ICdjJyAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50Lm5vZGVOYW1lID09PSAnSU5QVVQnKSB7CiAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7CiAgICAgIH0KCiAgICAgIGlmIChldmVudC50YXJnZXQubm9kZU5hbWUgPT09ICdJTlBVVCcgJiYgdGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wpIHsKICAgICAgICB0aGlzLmVTdGF0ZXMuY29weUJ5S2V5Qm9vbCA9IGZhbHNlOwogICAgICB9CgogICAgICBpZiAoZXZlbnQua2V5ID09PSAnYycpIHsKICAgICAgICB0aGlzLmVTdGF0ZXMuY29weUJ5S2V5Qm9vbCA9IHRydWU7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wgJiYgZXZlbnQua2V5ID09PSAndicpIHsKICAgICAgICB0aGlzLmNvcHlDdXJyZW50Q29tcCgpOwogICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5ub2RlTmFtZSAhPT0gJ0lOUFVUJykgewogICAgICAgIGlmIChbJ0Fycm93VXAnLCAnQXJyb3dEb3duJywgJ0Fycm93TGVmdCcsICJBcnJvd1JpZ2h0Il0uaW5kZXhPZihldmVudFsnY29kZSddKSA+IC0xKSB7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgIGlmICh0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID4gLTEgJiYgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICB0aGlzLmFycm93SXRlbShldmVudFsnY29kZSddLCB0aGlzLmVkcmF3Q29tcG9uZW50c1t0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4XSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHZhciBsZW4gPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIubGVuZ3RoOwoKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgIHRoaXMuYXJyb3dJdGVtKGV2ZW50Wydjb2RlJ10sIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChldmVudC5rZXkgPT09ICdEZWxldGUnIHx8IHRoaXMuaXNNYWMoKSAmJiBldmVudC5rZXkgPT09ICdCYWNrc3BhY2UnKSB7CiAgICAgICAgaWYgKCEoZXZlbnQudGFyZ2V0LmlubmVySFRNTCAmJiBldmVudC50YXJnZXQuY29udGVudEVkaXRhYmxlKSB8fCBldmVudC50YXJnZXQuY29udGVudEVkaXRhYmxlID09PSAnaW5oZXJpdCcpIHsKICAgICAgICAgIHRoaXMuZGVsQ29tcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFycm93SXRlbTogZnVuY3Rpb24gYXJyb3dJdGVtKGFycm93LCBvYmopIHsKICAgICAgaWYgKGFycm93ICYmIG9iaikgewogICAgICAgIHN3aXRjaCAoYXJyb3cpIHsKICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOgogICAgICAgICAgICBvYmouc3R5bGUudG9wID0gb2JqLnN0eWxlLnRvcCAtIDEgPiAwID8gb2JqLnN0eWxlLnRvcCAtIDEgOiAwOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICdBcnJvd0Rvd24nOgogICAgICAgICAgICBvYmouc3R5bGUudG9wID0gb2JqLnN0eWxlLnRvcCArIDE7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6CiAgICAgICAgICAgIG9iai5zdHlsZS5sZWZ0ID0gb2JqLnN0eWxlLmxlZnQgLSAxID4gMCA/IG9iai5zdHlsZS5sZWZ0IC0gMSA6IDA7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOgogICAgICAgICAgICBvYmouc3R5bGUubGVmdCA9IG9iai5zdHlsZS5sZWZ0ICsgMTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8g5aSa6YCJ5LqL5Lu2CiAgICBtb3VzZWRvd25GdW46IGZ1bmN0aW9uIG1vdXNlZG93bkZ1bihldmVudCkgewogICAgICB0aGlzLmVsaW1pbmF0ZUdob3N0aW5nKGV2ZW50KTsgLy8g5raI6Zmk5ouW5ou96ay85b2xCgogICAgICBpZiAoZXZlbnQgJiYgZXZlbnQuc2hpZnRLZXkgJiYgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA+IC0xKSB7CiAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleF0uaXNBY3RpdmUgPSBmYWxzZTsKICAgICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gLTE7CiAgICAgIH0KCiAgICAgIGlmICgoIWV2ZW50LnNoaWZ0S2V5IHx8ICFldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkgJiYgZXZlbnQuYnV0dG9uID09PSAwICYmIGV2ZW50LnRhcmdldC5pZCA9PT0gJ2NhbnZhcycgJiYgIWV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbXAtZWxlbWVudCcpKSB7CiAgICAgICAgdGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wgPSBmYWxzZTsKICAgICAgICB0aGlzLmluaXRDb21wU3RhdGUoKTsKICAgICAgfQogICAgfSwKICAgIC8vIOWIm+W7uuW9k+WJjee7hOS7tgogICAgY29weUN1cnJlbnRDb21wOiBmdW5jdGlvbiBjb3B5Q3VycmVudENvbXAoKSB7CiAgICAgIHZhciBfY3VyckNvbXAgPSB0aGlzLmVkcmF3Q29tcG9uZW50c1t0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4XTsKICAgICAgaWYgKCFfY3VyckNvbXApIHJldHVybjsKICAgICAgX2N1cnJDb21wLmlzQWN0aXZlID0gZmFsc2U7CgogICAgICB2YXIgX2NvcHkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF9jdXJyQ29tcCkpOwoKICAgICAgdmFyIF9zdHlsZSA9IF9jdXJyQ29tcC5zdHlsZTsKICAgICAgdmFyIF92YWwgPSAxMDsKICAgICAgdmFyIF9oID0gX3ZhbDsKICAgICAgX2NvcHkuc3R5bGUudG9wID0gcGFyc2VJbnQoX3N0eWxlLmhlaWdodCkgKyBwYXJzZUludChfc3R5bGUudG9wKSArIHBhcnNlSW50KF9oKTsKICAgICAgX2NvcHkuc3R5bGUudG9wID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oX2NvcHkuc3R5bGUudG9wLCB0aGlzLmNvbmZpZ3MubWF4SGllZ2h0KSk7CiAgICAgIF9jb3B5LmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHMucHVzaChfY29weSk7CiAgICAgIHRoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXggPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGggLSAxOyAvL+abtOaWsOa/gOa0u+e7hOS7tueahOS4i+aghwogICAgfSwKICAgIC8vIOWkmumAieaTjeS9nDrlj43pgIkv5riF56m65aSa6YCJL+WxnuaAp+W6lOeUqAogICAgc2V0TXVsdGlwbGVTdGF0ZTogZnVuY3Rpb24gc2V0TXVsdGlwbGVTdGF0ZShzdGF0ZSwgdmFsdWUpIHsKICAgICAgaWYgKHN0YXRlID09PSAnSXNvbWV0cmljJykgewogICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIHZhciBvYmogPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbaV07CiAgICAgICAgICB2YXIgYm9vbCA9IG9ialsnbXVsdGlwbGVBY3RpdmVCb29sJ107CgogICAgICAgICAgaWYgKCFib29sKSB7CiAgICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zcGxpY2UoaSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgbGVuID0gdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLmxlbmd0aDsKICAgICAgICB2YXIgdmFsID0gMDsKCiAgICAgICAgaWYgKHZhbHVlID09PSAncm93JykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyID0gdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGEuc3R5bGUubGVmdCkgLSBwYXJzZUludChiLnN0eWxlLmxlZnQpOwogICAgICAgICAgfSk7CgogICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxlbjsgX2krKykgewogICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltfaV07CgogICAgICAgICAgICBpZiAoX2kgPiAwKSB7CiAgICAgICAgICAgICAgaXRlbS5zdHlsZS5sZWZ0ID0gdmFsOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YWwgPSBwYXJzZUludChpdGVtLnN0eWxlLmxlZnQpICsgcGFyc2VJbnQoaXRlbS5zdHlsZS53aWR0aCkgKyBwYXJzZUludCh0aGlzLmNvbmZpZ3MuSXNvbWV0cmljX3Jvdyk7CiAgICAgICAgICAgIHZhbCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHZhbCwgdGhpcy5jb25maWdzLm1heFdpZHRoKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChhLnN0eWxlLnRvcCkgLSBwYXJzZUludChiLnN0eWxlLnRvcCk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBsZW47IF9pMisrKSB7CiAgICAgICAgICAgIHZhciBfaXRlbSA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltfaTJdOwoKICAgICAgICAgICAgaWYgKF9pMiA+IDApIHsKICAgICAgICAgICAgICBfaXRlbS5zdHlsZS50b3AgPSB2YWw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KF9pdGVtLnN0eWxlLmhlaWdodCkgKyBwYXJzZUludChfaXRlbS5zdHlsZS50b3ApICsgcGFyc2VJbnQodGhpcy5jb25maWdzLklzb21ldHJpY19jb2x1KTsKICAgICAgICAgICAgdmFsID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odmFsLCB0aGlzLmNvbmZpZ3MubWF4SGllZ2h0KSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAncmVTZWwnKSB7CiAgICAgICAgdmFyIF9sZW4gPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGg7CiAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyID0gW107CgogICAgICAgIGZvciAodmFyIF9pMyA9IF9sZW47IF9pMy0tOyBfaTMgPiAwKSB7CiAgICAgICAgICB2YXIgX2l0ZW0yID0gdGhpcy5lZHJhd0NvbXBvbmVudHNbX2kzXTsKCiAgICAgICAgICBpZiAoIV9pdGVtMi5tdWx0aXBsZUFjdGl2ZUJvb2wpIHsKICAgICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLnB1c2goX2l0ZW0yKTsKICAgICAgICAgIH0KCiAgICAgICAgICBfaXRlbTIubXVsdGlwbGVBY3RpdmVCb29sID0gIV9pdGVtMi5tdWx0aXBsZUFjdGl2ZUJvb2w7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAnY2xlYXInKSB7CiAgICAgICAgdmFyIF9sZW4yID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwoKICAgICAgICBmb3IgKHZhciBfaTQgPSBfbGVuMjsgX2k0LS07IF9pNCA+IDApIHsKICAgICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW19pNF0ubXVsdGlwbGVBY3RpdmVCb29sID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKFsnaXNBcHBseVNoYWRvdycsICdib3JkZXJSYWRpdXMnXS5pbmRleE9mKHN0YXRlKSA+IC0xKSB7CiAgICAgICAgdmFyIF9sZW4zID0gdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLmxlbmd0aDsKCiAgICAgICAgZm9yICh2YXIgX2k1ID0gX2xlbjM7IF9pNS0tOyBfaTUgPiAwKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbX2k1XS5zdHlsZVtzdGF0ZV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09ICdhbGlnbicpIHsKICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7CiAgICAgICAgICBjYXNlICd0JzoKICAgICAgICAgICAgdGhpcy5tdWx0aXBBcnJheSgndG9wJyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgJ2wnOgogICAgICAgICAgICB0aGlzLm11bHRpcEFycmF5KCdsZWZ0Jyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgJ2InOgogICAgICAgICAgICB0aGlzLm11bHRpcEFycmF5KCdib3R0b20nKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAncic6CiAgICAgICAgICAgIHRoaXMubXVsdGlwQXJyYXkoJ3JpZ2h0Jyk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWIoOmZpOWkmumAieWFg+e0oAogICAgZGVsTXVsdGlwQ29tcDogZnVuY3Rpb24gZGVsTXVsdGlwQ29tcChjb21wLCBpbmRleCkgewogICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIuc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgIHZhciBfaW5kZXggPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5pbmRleE9mKGNvbXApOwoKICAgICAgaWYgKF9pbmRleCA+IC0xKSB7CiAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbX2luZGV4XS5tdWx0aXBsZUFjdGl2ZUJvb2wgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGNoYW5nZUNvbmZpZzogZnVuY3Rpb24gY2hhbmdlQ29uZmlnKHN0YXRlLCB2YWx1ZSkgewogICAgICBpZiAoIXRoaXMuY29uZmlnc1tzdGF0ZV0pIHJldHVybjsKCiAgICAgIGlmIChzdGF0ZSA9PT0gJ2JnJykgewogICAgICAgIHRoaXMuY2hhbmdlQmdJbWcoKTsKICAgICAgfQoKICAgICAgdGhpcy5jb25maWdzW3N0YXRlXSA9IHZhbHVlOwogICAgfSwKICAgIG11bHRpcEFycmF5OiBmdW5jdGlvbiBtdWx0aXBBcnJheShwYXJhbSkgewogICAgICB2YXIgbGlzdCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyKSk7CiAgICAgIGxpc3Quc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgIHJldHVybiBbJ3RvcCcsICdsZWZ0J10uaW5kZXhPZihwYXJhbSkgPiAtMSA/IHBhcnNlSW50KGEuc3R5bGVbcGFyYW1dKSAtIHBhcnNlSW50KGIuc3R5bGVbcGFyYW1dKSA6IHBhcmFtID09PSAnYm90dG9tJyA/IHBhcnNlSW50KGIuc3R5bGUudG9wKSArIHBhcnNlSW50KGIuc3R5bGUuaGVpZ2h0KSAtIChwYXJzZUludChhLnN0eWxlLnRvcCkgKyBwYXJzZUludChhLnN0eWxlLmhlaWdodCkpIDogcGFyc2VJbnQoYi5zdHlsZS5sZWZ0KSArIHBhcnNlSW50KGIuc3R5bGUud2lkdGgpIC0gKHBhcnNlSW50KGEuc3R5bGUubGVmdCkgKyBwYXJzZUludChhLnN0eWxlLndpZHRoKSk7CiAgICAgIH0pOwogICAgICB2YXIgbGVuID0gdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLmxlbmd0aDsKICAgICAgdmFyIHJlc09iaiA9IGxpc3RbMF07CgogICAgICBpZiAoWyd0b3AnLCAnbGVmdCddLmluZGV4T2YocGFyYW0pID4gLTEpIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbaV0uc3R5bGVbcGFyYW1dID0gcmVzT2JqLnN0eWxlW3BhcmFtXTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFyYW0gPT09ICdib3R0b20nKSB7CiAgICAgICAgdmFyIF9ib3R0b20gPSBwYXJzZUludChyZXNPYmouc3R5bGUudG9wKSArIHBhcnNlSW50KHJlc09iai5zdHlsZS5oZWlnaHQpOwoKICAgICAgICBmb3IgKHZhciBfaTYgPSAwOyBfaTYgPCBsZW47IF9pNisrKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhfYm90dG9tLCB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbX2k2XS5zdHlsZS5oZWlnaHQsIF9ib3R0b20gLSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbX2k2XS5zdHlsZS5oZWlnaHQpOwogICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyW19pNl0uc3R5bGUudG9wID0gX2JvdHRvbSAtIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltfaTZdLnN0eWxlLmhlaWdodDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocGFyYW0gPT09ICdyaWdodCcpIHsKICAgICAgICB2YXIgX3JpZ2h0ID0gcGFyc2VJbnQocmVzT2JqLnN0eWxlLmxlZnQpICsgcGFyc2VJbnQocmVzT2JqLnN0eWxlLndpZHRoKTsKCiAgICAgICAgZm9yICh2YXIgX2k3ID0gMDsgX2k3IDwgbGVuOyBfaTcrKykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyW19pN10uc3R5bGUubGVmdCA9IF9yaWdodCAtIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltfaTddLnN0eWxlLndpZHRoOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGlzTWFjOiBmdW5jdGlvbiBpc01hYygpIHsKICAgICAgcmV0dXJuIC9tYWNpbnRvc2h8bWFjIG9zIHgvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgfSwKICAgIGNhbGNBbmdsZURlZ3JlZXM6IGZ1bmN0aW9uIGNhbGNBbmdsZURlZ3JlZXMoeCwgeSkgewogICAgICB2YXIgdmFsID0gTWF0aC5hdGFuMih5LCB4KSAqIDE4MCAvIE1hdGguUEk7CiAgICAgIHJldHVybiBNYXRoLmNlaWwodmFsKTsKICAgIH0sCiAgICBzZWxDb2xvcjogZnVuY3Rpb24gc2VsQ29sb3IoY29tcCwgY29sb3IpIHsKICAgICAgaWYgKHRoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXggPiAtMSAmJiB0aGlzLmVkcmF3Q29tcG9uZW50c1t0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4XSkgewogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW3RoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXhdLnN0eWxlLmNvbG9yID0gY29sb3I7CiAgICAgIH0KICAgIH0sCiAgICBzZWxCYWNrZ3JvdW5kOiBmdW5jdGlvbiBzZWxCYWNrZ3JvdW5kKGNvbXAsIGJnQ29sb3IpIHsKICAgICAgaWYgKHRoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXggPiAtMSAmJiB0aGlzLmVkcmF3Q29tcG9uZW50c1t0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4XSkgewogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW3RoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXhdLnN0eWxlLmJhY2tncm91bmQgPSBiZ0NvbG9yOwogICAgICB9CiAgICB9LAogICAgc2NyZWVuOiBmdW5jdGlvbiBzY3JlZW4oKSB7CiAgICAgIHRoaXMuY29uZmlncy5iZ0FsbEJvb2wgPSAhdGhpcy5jb25maWdzLmJnQWxsQm9vbDsKCiAgICAgIGlmICh0aGlzLmNvbmZpZ3MuYmdBbGxCb29sKSB7CiAgICAgICAgLy8gdGhpcy5jb25maWdzLndpbmRvd193ID0gd2luZG93LnNjcmVlbi53aWR0aCA+IDE1MDAgPyB3aW5kb3cuc2NyZWVuLndpZHRoIDogMTUwMDsKICAgICAgICAvLyB0aGlzLmNvbmZpZ3Mud2luZG93X2ggPSB3aW5kb3cuc2NyZWVuLmhlaWdodCA+IDgwMCA/IHdpbmRvdy5zY3JlZW4uaGVpZ2h0IDogODAwOwogICAgICAgIHRoaXMuY29uZmlncy53aW5kb3dfdyA9IDI5ODU7CiAgICAgICAgdGhpcy5jb25maWdzLndpbmRvd19oID0gMTQ0NTsKICAgICAgICB0aGlzLmNvbmZpZ3Muc2NhbGUgPSAxOwogICAgICB9CiAgICB9LAogICAgaW5pdFN0b3JhZ2VEYXRhOiBmdW5jdGlvbiBpbml0U3RvcmFnZURhdGEoY2xlYXJCb29sKSB7CiAgICAgIGlmICghY2xlYXJCb29sICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYm1fZGF0YXMnKSkgcmV0dXJuOwogICAgICB2YXIgcGFyYW1zID0gewogICAgICAgIHNhdmVfZGF0YV9hdXRvOiBbXSwKICAgICAgICBzYXZlX2RhdGFfY3VzdG9tOiBbXQogICAgICB9OwogICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2JtX2RhdGFzJywgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7CiAgICB9LAogICAgc2F2ZURhdGVUb1N0b3JhZ2U6IGZ1bmN0aW9uIHNhdmVEYXRlVG9TdG9yYWdlKGRhdGEsIHN0YXRlKSB7CiAgICAgIHZhciBzYXZlRGF0YSA9IGRhdGEgfHwgdGhpcy5lZHJhd0NvbXBvbmVudHM7IC8v5a2Y5YKo5LyY5YyW77yM5rKh5pyJ5YaF5a6555qE6aG16Z2i5LiN6ZyA6KaB5a2Y5YKoCgogICAgICBpZiAoIXNhdmVEYXRhIHx8IEFycmF5LmlzQXJyYXkoc2F2ZURhdGEpICYmIHNhdmVEYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG9iaiA9IHsKICAgICAgICBkYXRhOiBzYXZlRGF0YSwKICAgICAgICB0eXBlOiBzdGF0ZSB8fCAnYXV0bycsCiAgICAgICAgdXBkYXRlVGltZTogbmV3IERhdGUoKQogICAgICB9OwoKICAgICAgaWYgKCF3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2JtX2RhdGFzJykpIHsKICAgICAgICB0aGlzLmluaXRTdG9yYWdlRGF0YSgpOwogICAgICB9CgogICAgICB2YXIgcGFyYW1zID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdibV9kYXRhcycpOwoKICAgICAgaWYgKHBhcmFtcyAmJiB0eXBlb2YgcGFyYW1zID09PSAnc3RyaW5nJykgewogICAgICAgIHBhcmFtcyA9IEpTT04ucGFyc2UocGFyYW1zKTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLndlYkNvbmZpZykgewogICAgICAgIHRoaXMuaW5pdENvbmZpZygpOwogICAgICB9CgogICAgICBpZiAoc3RhdGUgPT09ICdjdXN0b20nKSB7CiAgICAgICAgcGFyYW1zLnNhdmVfZGF0YV9jdXN0b20udW5zaGlmdChvYmopOwoKICAgICAgICBpZiAocGFyYW1zLnNhdmVfZGF0YV9jdXN0b20ubGVuZ3RoID4gdGhpcy53ZWJDb25maWcuY3VzdG9tKSB7CiAgICAgICAgICBwYXJhbXMuc2F2ZV9kYXRhX2N1c3RvbSA9IHBhcmFtcy5zYXZlX2RhdGFfY3VzdG9tLnNsaWNlKDAsIHRoaXMud2ViQ29uZmlnLmN1c3RvbSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHBhcmFtcy5zYXZlX2RhdGFfYXV0by51bnNoaWZ0KG9iaik7CgogICAgICAgIGlmIChwYXJhbXMuc2F2ZV9kYXRhX2F1dG8ubGVuZ3RoID4gdGhpcy53ZWJDb25maWcuYXV0bykgewogICAgICAgICAgcGFyYW1zLnNhdmVfZGF0YV9hdXRvID0gcGFyYW1zLnNhdmVfZGF0YV9hdXRvLnNsaWNlKDAsIHRoaXMud2ViQ29uZmlnLmF1dG8pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fc2F2ZVdlYlN0b3JhZ2UocGFyYW1zKTsKCiAgICAgIHRoaXMuY3VycmVudEhpc3RvcnlJbmRleCA9IC0xOwogICAgfSwKICAgIGdldFN0b3JhZ2VEYXRhOiBmdW5jdGlvbiBnZXRTdG9yYWdlRGF0YShyZWxvYWRCb29sKSB7CiAgICAgIGlmICghcmVsb2FkQm9vbCkgewogICAgICAgIHRoaXMuYWN0aXZlSGlzdG9yeUJvb2wgPSAhdGhpcy5hY3RpdmVIaXN0b3J5Qm9vbDsKICAgICAgfQoKICAgICAgdGhpcy5jdXJyZW50SGlzdG9yeUluZGV4ID0gLTE7CiAgICAgIHZhciBwYXJhbXMgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2JtX2RhdGFzJyk7CgogICAgICBpZiAocGFyYW1zICYmIHR5cGVvZiBwYXJhbXMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcGFyYW1zID0gSlNPTi5wYXJzZShwYXJhbXMpOwogICAgICB9CgogICAgICB2YXIgbGlzdCA9IFtdLmNvbmNhdChwYXJhbXMuc2F2ZV9kYXRhX2N1c3RvbSwgcGFyYW1zLnNhdmVfZGF0YV9hdXRvKTsKICAgICAgdGhpcy5oaXN0b3J5Q3Vycm5ldERhdGEgPSBfLm9yZGVyQnkobGlzdCwgJ3VwZGF0ZVRpbWUnLCAiZGVzYyIpOwogICAgfSwKICAgIF9zYXZlV2ViU3RvcmFnZTogZnVuY3Rpb24gX3NhdmVXZWJTdG9yYWdlKHBhcmFtcywgZGVsU2F2ZUJvb2wpIHsKICAgICAgdmFyIHNlY2NNZXNzYWdlID0gZGVsU2F2ZUJvb2wgPyAi5Yig6Zmk5oiQ5YqfIiA6ICLkv53lrZjmiJDlip8iOwogICAgICB2YXIgZXJyTWVzc2FnZSA9IGRlbFNhdmVCb29sID8gIuWIoOmZpOWksei0pSIgOiBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkobG9jYWxTdG9yYWdlKS5sZW5ndGgpID4gMTAyNCAqIDEwMjQgKiA1IC0gMTAwID8gJ+aVsOaNrui2hei/h+WOhuWPsuaVsOaNruacgOWkp+WAvO+8jOivt+WIoOmZpOWOhuWPsuS4jemcgOimgeeahOaVsOaNrumHjeaWsOWtmOWCqCcgOiAi5L+d5a2Y5pWw5o2u5Ye66ZSZIjsKCiAgICAgIHRyeSB7CiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdibV9kYXRhcycsIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpOwogICAgICAgIHRoaXMuc2F2ZURhdGFJbmZvKCJzdWNjZXNzIiwgc2VjY01lc3NhZ2UpOwogICAgICB9IGNhdGNoIChfdW51c2VkKSB7CiAgICAgICAgdGhpcy5zYXZlRGF0YUluZm8oJ2Vycm9yJywgZXJyTWVzc2FnZSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmFjdGl2ZUhpc3RvcnlCb29sKSB7CiAgICAgICAgdGhpcy5nZXRTdG9yYWdlRGF0YSh0cnVlKTsKICAgICAgfQogICAgfSwKICAgIGluaXRDb25maWc6IGZ1bmN0aW9uIGluaXRDb25maWcoKSB7CiAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2JtX2RhdGFzJykpIHJldHVybjsKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBjdXN0b206IDUwLAogICAgICAgIGF1dG86IDUwCiAgICAgIH07CiAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY29uZmlncycsIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpOwogICAgfSwKICAgIGRlbGV0ZUhpc3RvcnlEYXRhOiBmdW5jdGlvbiBkZWxldGVIaXN0b3J5RGF0YShpbmRleCkgewogICAgICB2YXIgY3VycmVudERhdGEgPSB0aGlzLmhpc3RvcnlDdXJybmV0RGF0YVtpbmRleF07CgogICAgICBpZiAoY3VycmVudERhdGEpIHsKICAgICAgICBkZWxldGUgY3VycmVudERhdGEuaXNBY3RpdmU7CiAgICAgIH0KCiAgICAgIGlmICghd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdibV9kYXRhcycpKSB7CiAgICAgICAgdGhpcy5pbml0U3RvcmFnZURhdGEoKTsKICAgICAgfQoKICAgICAgdmFyIHBhcmFtcyA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYm1fZGF0YXMnKTsKCiAgICAgIGlmIChwYXJhbXMgJiYgdHlwZW9mIHBhcmFtcyA9PT0gJ3N0cmluZycpIHsKICAgICAgICBwYXJhbXMgPSBKU09OLnBhcnNlKHBhcmFtcyk7CiAgICAgIH0KCiAgICAgIGlmIChwYXJhbXMpIHsKICAgICAgICB2YXIgYyA9IHBhcmFtcy5zYXZlX2RhdGFfY3VzdG9tOwogICAgICAgIHZhciBsZW5fYyA9IGMubGVuZ3RoOwogICAgICAgIHZhciBoYXNCb29sID0gZmFsc2U7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuX2M7IGkrKykgewogICAgICAgICAgdmFyIGl0ZW0gPSBjW2ldOwoKICAgICAgICAgIGlmIChpdGVtICYmIGN1cnJlbnREYXRhICYmIGl0ZW0udXBkYXRlVGltZSA9PT0gY3VycmVudERhdGEudXBkYXRlVGltZSkgewogICAgICAgICAgICBwYXJhbXMuc2F2ZV9kYXRhX2N1c3RvbS5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgIGhhc0Jvb2wgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFoYXNCb29sKSB7CiAgICAgICAgICB2YXIgYSA9IHBhcmFtcy5zYXZlX2RhdGFfYXV0bzsKICAgICAgICAgIHZhciBsZW5fYSA9IGEubGVuZ3RoOwoKICAgICAgICAgIGZvciAodmFyIF9pOCA9IDA7IF9pOCA8IGxlbl9hOyBfaTgrKykgewogICAgICAgICAgICB2YXIgX2l0ZW0zID0gYVtfaThdOwoKICAgICAgICAgICAgaWYgKF9pdGVtMyAmJiBjdXJyZW50RGF0YSAmJiBfaXRlbTMudXBkYXRlVGltZSA9PT0gY3VycmVudERhdGEudXBkYXRlVGltZSkgewogICAgICAgICAgICAgIHBhcmFtcy5zYXZlX2RhdGFfYXV0by5zcGxpY2UoX2k4LCAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5fc2F2ZVdlYlN0b3JhZ2UocGFyYW1zLCB0cnVlKTsKICAgICAgfQogICAgfSwKICAgIGNsZWFyU3RvcmFnZURhdGE6IGZ1bmN0aW9uIGNsZWFyU3RvcmFnZURhdGEoKSB7CiAgICAgIHRoaXMuaW5pdFN0b3JhZ2VEYXRhKHRydWUpOwogICAgICB0aGlzLmdldFN0b3JhZ2VEYXRhKHRydWUpOwogICAgfSwKICAgIGNoYW5nZUJnSW1nOiBmdW5jdGlvbiBjaGFuZ2VCZ0ltZyh1cmwpIHsKICAgICAgdGhpcy5jb25maWdzLmJhY2tncm91bmRVcmwgPSB1cmw7CiAgICB9LAogICAgaW5pdEhpc3RvcnlMaXN0U3RhdGU6IGZ1bmN0aW9uIGluaXRIaXN0b3J5TGlzdFN0YXRlKGluZGV4KSB7CiAgICAgIHRoaXMuY3VycmVudEhpc3RvcnlJbmRleCA9IGluZGV4ID4gLTEgPyBpbmRleCA6IC0xOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5oaXN0b3J5Q3Vycm5ldERhdGEpKSB7CiAgICAgICAgdmFyIGxlbiA9IHRoaXMuaGlzdG9yeUN1cnJuZXREYXRhLmxlbmd0aDsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUN1cnJuZXREYXRhICYmIHRoaXMuaGlzdG9yeUN1cnJuZXREYXRhW2ldKSB7CiAgICAgICAgICAgIHRoaXMuaGlzdG9yeUN1cnJuZXREYXRhW2ldLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXBwbHlIaXN0b3J5OiBmdW5jdGlvbiBhcHBseUhpc3RvcnkobGlzdCkgewogICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cyA9IGxpc3Q7CiAgICAgIHRoaXMuaW5pdENvbXBTdGF0ZSgpOwogICAgICB0aGlzLmNsb3NlSGlzdG9yeSgpOwogICAgfSwKICAgIGNsb3NlSGlzdG9yeTogZnVuY3Rpb24gY2xvc2VIaXN0b3J5KCkgewogICAgICB0aGlzLmFjdGl2ZUhpc3RvcnlCb29sID0gZmFsc2U7CiAgICB9LAogICAgY2xlcmFySGlzdG9yeURhdGE6IGZ1bmN0aW9uIGNsZXJhckhpc3RvcnlEYXRhKCkgewogICAgICB0aGlzLmluaXRTdG9yYWdlRGF0YSh0cnVlKTsKICAgIH0sCiAgICBlbGltaW5hdGVHaG9zdGluZzogZnVuY3Rpb24gZWxpbWluYXRlR2hvc3RpbmcoZXZlbnQpIHsKICAgICAgdmFyIGRyYWdJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7CiAgICAgIGRyYWdJY29uLnNyYyA9ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUlBQUFBQUFBUC8vL3lINUJBRUFBQUFBTEFBQUFBQUJBQUVBQUFJQlJBQTcnLCBkcmFnSWNvbi53aWR0aCA9IDA7CiAgICAgIGRyYWdJY29uLmhlaWdodCA9IDA7CiAgICAgIGRyYWdJY29uLm9wYWNpdHkgPSAwOwoKICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LmRhdGFUcmFuc2ZlcikgewogICAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UoZHJhZ0ljb24sIDAsIDApOwogICAgICB9CiAgICB9LAogICAgc2F2ZURhdGFJbmZvOiBmdW5jdGlvbiBzYXZlRGF0YUluZm8oc3RhdGUsIG1zZ3MpIHsKICAgICAgdmFyIHR5cGUgPSBzdGF0ZSB8fCAnc3VjY2Vzcyc7CiAgICAgIHZhciBtc2cgPSBtc2dzIHx8ICfmlbDmja7kv53lrZjmiJDlip/vvIEnOwogICAgICBWdWUuJHRvYXN0Lm9wZW4oewogICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgbWVzc2FnZTogbXNnLAogICAgICAgIHBvc2l0aW9uOiAndG9wLXJpZ2h0JwogICAgICB9KTsKICAgIH0sCiAgICB6b29tOiBmdW5jdGlvbiB6b29tKHN0YXRlKSB7CiAgICAgIGlmIChzdGF0ZSA9PT0gJ3pvb21vdXQnKSB7CiAgICAgICAgdGhpcy5jb25maWdzLnNjYWxlID0gTWF0aC5tYXgodGhpcy5jb25maWdzLnNjYWxlIC0gMC4xLCAwLjcpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29uZmlncy5zY2FsZSA9IE1hdGgubWluKHRoaXMuY29uZmlncy5zY2FsZSArIDAuMSwgMS41KTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/liangma/Desktop/workspace/BaseMap/src/components/editor/editor.vue.js"],"names":["Vue","EditorComps","EditorCanvas","EditorSettings","EditorHelp","EditorHistory","_","name","created","initStorageData","initBindingEvent","initData","mounted","data","eStates","currentActiveIndex","copyByKeyBool","multipleActiveArr","edrawComponents","configs","bg","pageName","spacing","scale","dragIconSize","Isometric_row","Isometric_colu","dowloadImgType","bgAllBool","width","height","maxWidth","maxHieght","backgroundUrl","webConfig","custom","auto","historyCurrnetData","currentHistoryIndex","activeHistoryBool","components","methods","document","addEventListener","kaydownFun","mousedownFun","window","leaving","event","message","returnValue","download","saveAs","img","_dom","createElement","href","dataset","downloadurl","join","body","appendChild","click","removeChild","selectComp","comp","item","JSON","parse","stringify","initCompState","isActive","multipleActiveBool","rect","getElementById","getClientRects","defStyle","borderRadius","rotate","borderWidth","background","isApplyShadow","bgiBool","color","border","opacity","clientX","clientY","_style","top","left","drag_start_x","drag_start_y","undefined","position","isFixed","fontSize","Math","max","min","style","push","length","initComponentState","current","shiftKey","metaKey","isMac","button","_multipActiveIndex","indexOf","splice","len","i","dragCurrentComp","state","currentIndex","console","log","_rect","_l","_t","_left","_top","eliminateGhosting","resizeByDragComp","arrow","_width","_height","parseInt","transComp","_x","_y","calcAngleDegrees","changeTextVal","val","target","innerText","value","delComp","index","multipBool","key","activeElement","nodeName","blur","copyCurrentComp","preventDefault","arrowItem","innerHTML","contentEditable","obj","id","classList","contains","_currComp","_copy","_val","_h","setMultipleState","bool","sort","a","b","multipArray","delMultipComp","_index","changeConfig","changeBgImg","param","list","resObj","_bottom","_right","test","navigator","userAgent","x","y","atan2","PI","ceil","selColor","selBackground","bgColor","screen","window_w","window_h","clearBool","localStorage","getItem","params","save_data_auto","save_data_custom","setItem","saveDateToStorage","saveData","Array","isArray","type","updateTime","Date","initConfig","unshift","slice","_saveWebStorage","getStorageData","reloadBool","concat","orderBy","delSaveBool","seccMessage","errMessage","encodeURIComponent","saveDataInfo","deleteHistoryData","currentData","c","len_c","hasBool","len_a","clearStorageData","url","initHistoryListState","applyHistory","closeHistory","clerarHistoryData","dragIcon","src","dataTransfer","setDragImage","msgs","msg","$toast","open","zoom"],"mappings":"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","sourcesContent":["import Vue from 'vue';\nimport EditorComps from './../../components/comps/editor-comps'\nimport EditorCanvas from './../../components/canvas/editor-canvas';\nimport EditorSettings from './../../components/settings/editor-settings';\nimport EditorHelp from './../../components/help/editor-help';\nimport EditorHistory from './../../components/history/editor-history';\nimport _ from 'lodash';  \n\nexport default {\n  name: 'Editor',\n  created:function() {\n    this.initStorageData();\n    this.initBindingEvent();\n    this.initData\n  },\n  mounted:function() {\n\n  },\n  \n  data(){\n     return {\n        eStates:{\n          currentActiveIndex:-1,\n          copyByKeyBool:false,\n          multipleActiveArr:[],\n        },\n        edrawComponents:[],\n        configs:{\n          bg:\"grid\",\n          pageName:'底图',\n          spacing:10,\n          scale:1,\n          dragIconSize:2,\n          Isometric_row:10,\n          Isometric_colu:10,\n          dowloadImgType:'png',\n          bgAllBool:false,\n          width: 2945,\n          height: 1445,\n          maxWidth:3445,\n          maxHieght:1505,\n          backgroundUrl:\"\",\n        },\n        webConfig: {\n          custom: 25,\n          auto:5,\n        },\n        historyCurrnetData:[],\n        currentHistoryIndex:-1,\n        activeHistoryBool:false\n     }\n  },\n  components: {\n    'editor-comps':EditorComps,\n    'editor-canvas':EditorCanvas,\n    'editor-settings':EditorSettings,\n    'editor-help':EditorHelp,\n    'editor-history':EditorHistory\n  },\n  methods: {\n    initData() {\n      this.activeHistoryBool = false;\n    },\n    initBindingEvent() {\n      document.addEventListener('keydown', this.kaydownFun, false);\n      document.addEventListener('mousedown', this.mousedownFun);\n      window.addEventListener('beforeunload', this.leaving);\n    },\n    leaving(event) {\n      // this.saveDateToStorage();\n      // console.log(event.returnValue)\n      let message = \"内容更改，注意截图缓存\"; \n      event.returnValue = message;\n      return message;\n    },\n    download:function() {\n      //TODO:页面下载\n    },\n    saveAs:function(img) {\n      let _dom = window.document.createElement('a');\n        _dom.href = img\n        _dom.dataset.downloadurl = ['image/png', 'IMG_DOWNLOAD_NAME', _dom.href].join(':');\n        document.body.appendChild(_dom);\n        _dom.click();\n        document.body.removeChild(_dom);\n    },\n    // 组件选择\n    selectComp(event, comp) {\n      let item = JSON.parse(JSON.stringify(comp));\n      if(!item) return;\n      this.initCompState();\n      item.isActive = true;\n      item.multipleActiveBool=false;\n      let rect = document.getElementById('canvas').getClientRects()[0];\n      let {\n        width, \n        height, \n        borderRadius, \n        rotate, \n        borderWidth, \n        background, \n        isApplyShadow, \n        bgiBool, \n        color,\n        border,\n        opacity } = item.defStyle;\n      let {clientX , clientY} = event;\n      let _style = {\n          width:width || 100,\n          height:height || 100,\n          top: (clientY  - rect.top + 60 || 100)/ this.configs.scale,\n          left:(clientX +213 - rect.left || 100) / this.configs.scale,\n          rotate: rotate || 0,\n          drag_start_x: 0, //拖拽相对\n          drag_start_y :0,\n          borderWidth:borderWidth || 0,\n          background:background,\n          isApplyShadow:isApplyShadow  === undefined || isApplyShadow === null ? 'true' : 'false',\n          position:'absolute',\n          isFixed:\"false\",\n          bgiBool:bgiBool || false, //材质\n          borderRadius:borderRadius || 0,\n          border:border ,\n          fontSize: 14,\n          opacity:opacity,\n          color: color\n      }\n      _style.left =Math.max(0,  Math.min(_style.left, this.configs.maxWidth));\n      _style.top =Math.max(0,  Math.min(_style.top, this.configs.maxHieght));\n      item.style = _style;\n      this.edrawComponents.push(item);\n      this.eStates.currentActiveIndex = this.edrawComponents.length -1;\n    },\n    initComponentState(current, event) {\n      if(current === undefined || current === null || current === -1) return;\n      if(event && (event.shiftKey || event.metaKey && this.isMac()) && event.button === 0 ) {\n        this.edrawComponents[current].isActive = false;\n        if(this.eStates.currentActiveIndex > -1) {\n          this.eStates.currentActiveIndex = -1;\n        }\n\n        // 多选操作缓存数组\n        const _multipActiveIndex = this.eStates.multipleActiveArr.indexOf(this.edrawComponents[current]);\n        if( _multipActiveIndex === -1) {\n          this.eStates.multipleActiveArr.push(this.edrawComponents[current])\n        }\n\n        if(this.edrawComponents[current].multipleActiveBool) {\n          this.edrawComponents[current].multipleActiveBool = false;\n          this.eStates.multipleActiveArr.splice(_multipActiveIndex, 1);\n        } else {\n          this.edrawComponents[current].multipleActiveBool = true;\n        }\n      }else {\n        this.initCompState();     \n        this.eStates.currentActiveIndex = current;\n        this.edrawComponents[current].isActive = true;\n      }\n    },\n    // 初始化画布内组件状态\n    initCompState() {\n      let len = this.edrawComponents.length;\n      this.eStates.multipleActiveArr = [];\n      for(let i=0;i<len;i++) {\n        this.edrawComponents[i].isActive = false;\n        this.edrawComponents[i].multipleActiveBool = false;\n      }\n      this.eStates.copyByKeyBool = false;\n    },\n    // 组件拖拽：shiftKey === true 处理多选\n    dragCurrentComp(event, comp, state, currentIndex) {\n      if(event && (event.shiftKey || event.metaKey && this.isMac())  ){\n        console.log('多选处理')\n      } else {\n        this.eStates.copyByKeyBool = false;\n        let _rect = document.getElementById('canvas').getClientRects()[0]\n        let _l =_rect.left;\n        let _t =_rect.left;\n        if(state === 'start') {\n          this.eStates.currentActiveIndex = currentIndex;\n          comp.style.drag_start_x = (event.clientX - _l )/this.configs.scale - comp.style.left + 213;\n          comp.style.drag_start_y = (event.clientY -_t)/this.configs.scale  - comp.style.top + 60;\n        }else if(state === 'drag'){\n          let _left = (event.clientX   - _l)/this.configs.scale  - comp.style.drag_start_x + 213; \n          let _top = (event.clientY - _t)/this.configs.scale - comp.style.drag_start_y  + 60;\n          if(_left <0 || _top < 0) return;\n          _left =Math.max(0,  Math.min(_left, this.configs.maxWidth));\n          _top = Math.max(0, Math.min(_top, this.configs.maxHieght));\n          comp.style.left = _left;\n          comp.style.top = _top ;\n        }\n        if(['start', 'drag'].indexOf(state) > -1) {\n          this.eliminateGhosting(event); // 消除拖拽鬼影\n        } \n        \n      }\n    },\n    resizeByDragComp(event, comp, state, arrow,currentIndex) {\n      if(event && (event.shiftKey || event.metaKey && this.isMac())  ){\n        console.log('多选处理')\n      } else {\n        this.eStates.copyByKeyBool = false;\n        let _l = document.getElementById('canvas').getClientRects()[0].left;\n        let _t = document.getElementById('canvas').getClientRects()[0].top;\n        if(state === 'start') {\n          this.eStates.currentActiveIndex = currentIndex;\n          comp.style.drag_start_x = arrow === 'r' ? comp.style.left:\n                                    arrow === 'l' ? comp.style.left + comp.style.width:\n                                    10;\n          comp.style.drag_start_y = arrow === 'b' ? comp.style.top  :\n                                    arrow === 't' ? comp.style.top + comp.style.height  :\n                                    10;\n        }else if(state === 'drag'){\n          let _width = 0;\n          let _top = 0;\n          let _height = 0;\n     \n          switch(arrow) {\n            case 'r':\n              _width = parseInt((event.clientX- _l) /this.configs.scale) - comp.style.drag_start_x  + 213; \n              comp.style.width = Math.max(Math.min(_width, this.configs.width), 10);\n              break;\n            case 'b':\n              _top = parseInt((event.clientY - _t) / this.configs.scale) - comp.style.drag_start_y + 60;\n              comp.style.height = Math.max(Math.min(_top, this.configs.maxWidth), 10);\n              break;\n            case 'l':\n              comp.style.left = parseInt((event.clientX - _l)/this.configs.scale + 213) ; \n              _width = parseInt(comp.style.drag_start_x - comp.style.left ) ;\n              _width =Math.max(0,  Math.min(_width, this.configs.maxWidth));\n              comp.style.width = Math.max(_width, 10);\n              break;\n            case 't':\n              comp.style.top = (event.clientY -_t )/ this.configs.scale + 60;\n              _height = parseInt(comp.style.drag_start_y - comp.style.top)\n              _height =Math.max(10,  Math.min(_height, this.configs.maxWidth));\n              comp.style.height = Math.max(_height, 10);\n              break;\n            default:\n              break\n          }\n        }\n      }\n    },\n    transComp(event, comp){\n        let _x = event.clientX - comp.style.left - comp.style.width / 2;\n        let _y = event.clientY - comp.style.top - comp.style.height / 2;\n        comp.style.rotate = this.calcAngleDegrees(_x, _y);\n    },\n    changeTextVal(event, item) {\n      let val = event.target.innerText;\n      if(event && item) {\n        item.value = val;\n        event.target.innerText = item.value;\n      }\n    },\n    // 组件删除\n    delComp(index, state) {\n      if(state === 'multipleDel') {\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          let multipBool = this.edrawComponents[i].multipleActiveBool;\n          if(multipBool) {\n            this.edrawComponents.splice(i,1)\n          }\n        }\n      } else {\n        if(this.eStates.currentActiveIndex > -1 &&this.edrawComponents.length > 0) {\n          this.edrawComponents.splice(this.eStates.currentActiveIndex,1)\n          this.eStates.currentActiveIndex = -1;\n        }\n      }\n    },\n    // 键盘事件\n    kaydownFun(event) {\n      if(event.key === 'v' && document.activeElement.nodeName === 'INPUT') {\n        return;\n      }else if(event.key === 'c' &&  document.activeElement.nodeName === 'INPUT') {\n        document.activeElement.blur();\n      }\n      if(event.target.nodeName === 'INPUT' && this.eStates.copyByKeyBool) {\n         this.eStates.copyByKeyBool = false;\n      }\n      if(event.key === 'c') {\n        this.eStates.copyByKeyBool = true;\n      }else if(this.eStates.copyByKeyBool && event.key === 'v') {\n        this.copyCurrentComp();\n      }else if(event.target.nodeName !== 'INPUT'){\n        if(['ArrowUp','ArrowDown','ArrowLeft',\"ArrowRight\"].indexOf(event['code'])> -1) {\n          event.preventDefault();\n          if(this.eStates.currentActiveIndex > -1 && this.eStates.multipleActiveArr.length === 0) {\n            this.arrowItem(event['code'], this.edrawComponents[this.eStates.currentActiveIndex])\n          }else if(this.eStates.multipleActiveArr.length > 0){\n            let len = this.eStates.multipleActiveArr.length;\n            for(let i=0;i<len;i++){\n               this.arrowItem(event['code'], this.eStates.multipleActiveArr[i])\n            }\n          }\n        }\n      }\n      if(event.key === 'Delete' || this.isMac() && event.key === 'Backspace')  {\n        if(!(event.target.innerHTML && event.target.contentEditable) || event.target.contentEditable === 'inherit') {\n          this.delComp();\n        }\n      }\n    },\n    arrowItem(arrow, obj) {\n      if(arrow && obj) {\n        switch (arrow) {\n          case 'ArrowUp' :\n            obj.style.top = (obj.style.top - 1) > 0 ? ( obj.style.top - 1) : 0;\n            break;\n          case 'ArrowDown' :\n            obj.style.top = obj.style.top + 1;\n            break;\n          case 'ArrowLeft' :\n            obj.style.left = (obj.style.left -1 )> 0? (obj.style.left -1) : 0;\n            break;\n          case 'ArrowRight':\n            obj.style.left =  obj.style.left +1;\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    // 多选事件\n    mousedownFun(event) {\n      this.eliminateGhosting(event); // 消除拖拽鬼影\n      if(event && event.shiftKey && this.eStates.currentActiveIndex > -1) {\n        this.edrawComponents[this.eStates.currentActiveIndex].isActive = false;\n        this.eStates.currentActiveIndex = -1;\n      }\n      if((!event.shiftKey || !event.metaKey && this.isMac()) && event.button === 0 \n        && event.target.id==='canvas' \n        && !event.target.classList.contains('comp-element')) {\n        this.eStates.copyByKeyBool = false;\n        this.initCompState();\n      } \n    },\n    // 创建当前组件\n    copyCurrentComp:function() {\n      let _currComp = this.edrawComponents[this.eStates.currentActiveIndex];\n      if(!_currComp) return;\n      _currComp.isActive = false;\n      let _copy = JSON.parse(JSON.stringify(_currComp));\n      let _style = _currComp.style;\n      let _val = 10;\n      let _h = _val;\n      _copy.style.top = parseInt(_style.height) + parseInt(_style.top) + parseInt(_h);\n      _copy.style.top = Math.max(0, Math.min(_copy.style.top, this.configs.maxHieght));\n      _copy.isActive = true;\n      this.edrawComponents.push(_copy);\n      this.eStates.currentActiveIndex = this.edrawComponents.length - 1; //更新激活组件的下标\n    },\n    // 多选操作:反选/清空多选/属性应用\n    setMultipleState:function(state, value) {\n      if(state === 'Isometric') {\n        for(let i = this.eStates.multipleActiveArr.length-1;i>=0;i--) {\n          let obj = this.eStates.multipleActiveArr[i];\n          let bool = obj['multipleActiveBool'];\n          if(!bool) {\n            this.eStates.multipleActiveArr.splice(i,1);\n          }\n        }\n        let len = this.eStates.multipleActiveArr.length;\n        let val = 0;\n        if(value === 'row') {\n          this.eStates.multipleActiveArr =  this.eStates.multipleActiveArr.sort(function(a,b){\n            return parseInt(a.style.left) - parseInt(b.style.left);\n          })\n          for(let i=0;i< len;i++) {\n            let item = this.eStates.multipleActiveArr[i];\n            if(i>0) {\n              item.style.left = val;\n            }\n            val = parseInt(item.style.left) + parseInt(item.style.width) + parseInt(this.configs.Isometric_row);\n            val = Math.max(0, Math.min(val, this.configs.maxWidth));\n          }\n        } else {\n          this.eStates.multipleActiveArr =  this.eStates.multipleActiveArr.sort(function(a,b){\n            return parseInt(a.style.top) - parseInt(b.style.top) ;\n          })\n          for(let i=0;i< len;i++) {\n            let item = this.eStates.multipleActiveArr[i];\n            if(i>0) {\n              item.style.top = val;\n            }\n            val = parseInt(item.style.height) + parseInt(item.style.top) + parseInt(this.configs.Isometric_colu);\n            val = Math.max(0,  Math.min(val, this.configs.maxHieght));\n          }\n        }     \n      }else if(state === 'reSel') {\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          let item = this.edrawComponents[i];\n          if(!item.multipleActiveBool) {  \n            this.eStates.multipleActiveArr.push(item);\n          }\n          item.multipleActiveBool = !item.multipleActiveBool;\n        }\n      } else if(state === 'clear'){\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          this.edrawComponents[i].multipleActiveBool = false;\n        }\n      }else if(['isApplyShadow', 'borderRadius'].indexOf(state) > -1) {\n        let len = this.eStates.multipleActiveArr.length;\n        for(let i=len;i--;i >0) {\n          this.eStates.multipleActiveArr[i].style[state] = value;\n        }\n      }else if(state === 'align') {\n        switch(value) {\n          case 't' :\n            this.multipArray('top');\n            break;\n          case 'l' :\n            this.multipArray('left');\n            break;\n          case 'b' :\n            this.multipArray('bottom');\n            break;\n          case 'r' :\n            this.multipArray('right');\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    // 删除多选元素\n    delMultipComp(comp, index) {\n      this.eStates.multipleActiveArr.splice(index, 1);\n      let _index = this.edrawComponents.indexOf(comp);\n      if(_index > -1) {\n        this.edrawComponents[_index].multipleActiveBool = false;\n      }\n    },\n    changeConfig(state, value){\n      if(!this.configs[state]) return;\n      if(state === 'bg') {\n        this.changeBgImg()\n      }\n      this.configs[state] = value;\n    },\n    multipArray(param) {\n      let list = JSON.parse(JSON.stringify(this.eStates.multipleActiveArr));\n      list.sort(function(a, b) {\n        return ['top', 'left'].indexOf(param) > -1 ? parseInt(a.style[param]) - parseInt(b.style[param]):\n          param === 'bottom' ? parseInt(b.style.top) + parseInt(b.style.height) - (parseInt(a.style.top) + parseInt(a.style.height)) :\n          parseInt(b.style.left) + parseInt(b.style.width) - (parseInt(a.style.left) + parseInt(a.style.width)) \n      });\n      let len = this.eStates.multipleActiveArr.length;\n      let resObj = list[0];\n      if(['top', 'left'].indexOf(param) > -1) {\n        for(let i=0;i<len;i++) {\n          this.eStates.multipleActiveArr[i].style[param] = resObj.style[param];\n        }\n      }else if(param === 'bottom') {\n        let _bottom = parseInt( resObj.style.top )+ parseInt(resObj.style.height);\n        for(let i=0;i<len;i++) {\n          console.log(_bottom, this.eStates.multipleActiveArr[i].style.height, _bottom- this.eStates.multipleActiveArr[i].style.height)\n          this.eStates.multipleActiveArr[i].style.top = _bottom - this.eStates.multipleActiveArr[i].style.height;\n        }\n      }else if(param === 'right') {\n        let _right = parseInt(resObj.style.left) + parseInt(resObj.style.width);\n        for(let i=0;i<len;i++) {\n          this.eStates.multipleActiveArr[i].style.left = _right - this.eStates.multipleActiveArr[i].style.width;\n        }\n      }\n    },\n    isMac:function() {\n      return /macintosh|mac os x/i.test(navigator.userAgent)\n    },\n    calcAngleDegrees(x, y) {\n      let val =  Math.atan2(y, x) * 180 / Math.PI;\n      return Math.ceil(val);\n    },\n    selColor(comp, color) {\n      if(this.eStates.currentActiveIndex > -1 && this.edrawComponents[this.eStates.currentActiveIndex]) {\n        this.edrawComponents[this.eStates.currentActiveIndex].style.color = color;\n      }\n    },\n    selBackground(comp, bgColor) {\n      if(this.eStates.currentActiveIndex > -1 && this.edrawComponents[this.eStates.currentActiveIndex]) {\n        this.edrawComponents[this.eStates.currentActiveIndex].style.background = bgColor;\n      }\n    },\n    screen:function() {\n      this.configs.bgAllBool = !this.configs.bgAllBool;\n      if(this.configs.bgAllBool) {\n        // this.configs.window_w = window.screen.width > 1500 ? window.screen.width : 1500;\n        // this.configs.window_h = window.screen.height > 800 ? window.screen.height : 800;\n        this.configs.window_w = 2985;\n        this.configs.window_h = 1445\n        this.configs.scale = 1;\n      }\n    },\n    initStorageData(clearBool) {\n      if(!clearBool && window.localStorage.getItem('bm_datas')) return;\n      let params = {\n          save_data_auto:[],\n          save_data_custom:[]\n      }\n      window.localStorage.setItem('bm_datas', JSON.stringify(params));\n    },\n    saveDateToStorage(data, state) {\n      let saveData = data || this.edrawComponents;\n      //存储优化，没有内容的页面不需要存储\n      if(!saveData || Array.isArray(saveData) && saveData.length === 0) {\n        return;\n      }\n      let obj = {\n        data: saveData,\n        type: state || 'auto',\n        updateTime:new Date()\n      };\n      if(!window.localStorage.getItem('bm_datas')) {\n        this.initStorageData();\n      }\n      let params = window.localStorage.getItem('bm_datas');\n      if(params && typeof params === 'string') {\n        params = JSON.parse(params)\n      }\n      if(!this.webConfig) {\n        this.initConfig();\n      }\n      if(state === 'custom') {\n        params.save_data_custom.unshift(obj);\n        if(params.save_data_custom.length >  this.webConfig.custom) {\n          params.save_data_custom = params.save_data_custom.slice(0, this.webConfig.custom);\n        }\n      } else {\n        params.save_data_auto.unshift(obj);\n        if(params.save_data_auto.length >  this.webConfig.auto) {\n          params.save_data_auto = params.save_data_auto.slice(0,  this.webConfig.auto);\n        }\n      }\n      this._saveWebStorage(params);\n      this.currentHistoryIndex = -1;\n    },\n    getStorageData(reloadBool) {\n      if(!reloadBool) {\n        this.activeHistoryBool = !this.activeHistoryBool;\n      }\n      this.currentHistoryIndex = -1;\n      let params = window.localStorage.getItem('bm_datas');\n      if(params && typeof params === 'string') {\n        params = JSON.parse(params)\n      }\n      let list = [].concat(params.save_data_custom, params.save_data_auto);\n      this.historyCurrnetData = _.orderBy(list, 'updateTime', \"desc\");\n    },\n    _saveWebStorage(params, delSaveBool) {\n      let seccMessage = delSaveBool ? \"删除成功\": \"保存成功\";\n      let errMessage  = delSaveBool ? \"删除失败\": \n                        encodeURIComponent(JSON.stringify(localStorage).length) > (1024 * 1024 * 5 - 100) ? '数据超过历史数据最大值，请删除历史不需要的数据重新存储' :\"保存数据出错\";\n      try {\n        window.localStorage.setItem('bm_datas', JSON.stringify(params));\n        this.saveDataInfo(\"success\",seccMessage);\n      }catch {\n        this.saveDataInfo('error',errMessage)\n      }\n      if(this.activeHistoryBool) {\n        this.getStorageData(true);\n      }\n    },\n    initConfig() {\n      if(window.localStorage.getItem('bm_datas')) return;\n      let params = {\n        custom:50,\n        auto:50,\n      }\n      window.localStorage.setItem('configs', JSON.stringify(params));\n    },\n    deleteHistoryData(index) {\n      let currentData = this.historyCurrnetData[index];\n      if(currentData) {\n        delete currentData.isActive;\n      }\n      if(!window.localStorage.getItem('bm_datas')) {\n        this.initStorageData();\n      }\n      let params = window.localStorage.getItem('bm_datas');\n      if(params && typeof params === 'string') {\n        params = JSON.parse(params);\n      }\n      if(params) {\n        let c = params.save_data_custom\n        let len_c =  c.length;\n        let hasBool = false;\n        for(let i=0;i<len_c;i++) {\n          let item = c[i];\n          if(item && currentData && item.updateTime === currentData.updateTime) {\n            params.save_data_custom.splice(i, 1);\n            hasBool = true;\n          }\n        }\n        if(!hasBool) {\n          let a = params.save_data_auto;\n          let len_a = a.length;\n          for(let i=0;i<len_a;i++) {\n            let item = a[i];\n            if(item && currentData && item.updateTime === currentData.updateTime) {\n              params.save_data_auto.splice(i, 1);\n            }\n          }\n        }\n        this._saveWebStorage(params, true)\n      }\n    },\n    clearStorageData() {\n      this.initStorageData(true);\n      this.getStorageData(true);\n    },\n    changeBgImg(url) {\n      this.configs.backgroundUrl = url;\n    },\n    initHistoryListState(index) {\n      this.currentHistoryIndex = index > -1 ? index : -1;\n      if(Array.isArray(this.historyCurrnetData)) {\n        let len = this.historyCurrnetData.length;\n        for(let i=0;i<len;i++) {\n            if(this.historyCurrnetData && this.historyCurrnetData[i]) {\n             this.historyCurrnetData[i].isActive = false;\n           }\n        }\n      }\n    },\n    applyHistory(list) {\n      this.edrawComponents = list;\n      this.initCompState();\n      this.closeHistory();\n    },\n    closeHistory() {\n      this.activeHistoryBool = false;\n    },\n    clerarHistoryData(){\n      this.initStorageData(true);\n    },\n    eliminateGhosting(event) {\n      let dragIcon = document.createElement('img');\n      dragIcon.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      dragIcon.width = 0;\n      dragIcon.height = 0;\n      dragIcon.opacity = 0;\n      if(event && event.dataTransfer) {\n        event.dataTransfer.setDragImage(dragIcon,0, 0);\n      }\n\n    },\n    saveDataInfo:function(state, msgs) {\n      let type = state || 'success';\n      let msg = msgs || '数据保存成功！';\n      Vue.$toast.open({\n        type:type,\n        message:msg,\n        position:'top-right'\n      });\n    },\n    zoom:function(state) {\n      if(state === 'zoomout') {\n        this.configs.scale = Math.max(this.configs.scale - 0.1, 0.7);\n      }else {\n        this.configs.scale = Math.min(this.configs.scale + 0.1, 1.5);\n      }\n    }\n  }\n}"]}]}