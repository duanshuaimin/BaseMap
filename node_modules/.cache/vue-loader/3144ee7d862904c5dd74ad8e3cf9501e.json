{"remainingRequest":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangma/Desktop/workspace/BaseMap/src/components/editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangma/Desktop/workspace/BaseMap/src/components/editor.vue","mtime":1588419719369},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFZGl0b3JDb21wcyBmcm9tICcuL2VkaXRvci1jb21wcyc7CmltcG9ydCBFZGl0b3JDYW52YXMgZnJvbSAnLi9lZGl0b3ItY2FudmFzJzsKaW1wb3J0IEVkaXRvclNldHRpbmdzIGZyb20gJy4vZWRpdG9yLXNldHRpbmdzJzsKaW1wb3J0IEVkaXRvckhlbHAgZnJvbSAnLi9lZGl0b3ItaGVscCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRWRpdG9yJywKICBjcmVhdGVkOmZ1bmN0aW9uKCkgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2F5ZG93bkZ1bik7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm1vdXNlZG93bkZ1bikKICB9LAogIGRhdGEoKXsKICAgICByZXR1cm4gewogICAgICAgIGVTdGF0ZXM6ewogICAgICAgICAgY3VycmVudEFjdGl2ZUluZGV4Oi0xLAogICAgICAgICAgY29weUJ5S2V5Qm9vbDpmYWxzZSwKICAgICAgICAgIG11bHRpcGxlQWN0aXZlQXJyOltdLAogICAgICAgIH0sCiAgICAgICAgZWRyYXdDb21wb25lbnRzOltdLAogICAgICAgIGNvbmZpZ3M6ewogICAgICAgICAgYmc6ImdyaWQiLAogICAgICAgICAgcGFnZU5hbWU6J+W6leWbvicsCiAgICAgICAgICBzcGFjaW5nOjEwLAogICAgICAgICAgZG93bG9hZEltZ1R5cGU6J3BuZycKICAgICAgICB9CiAgICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgJ2VkaXRvci1jb21wcyc6RWRpdG9yQ29tcHMsCiAgICAnZWRpdG9yLWNhbnZhcyc6RWRpdG9yQ2FudmFzLAogICAgJ2VkaXRvci1zZXR0aW5ncyc6RWRpdG9yU2V0dGluZ3MsCiAgICAnZWRpdG9yLWhlbHAnOkVkaXRvckhlbHAKICB9LAogIG1ldGhvZHM6IHsKICAgIAogICAgLy8g57uE5Lu26YCJ5oupCiAgICBzZWxlY3RDb21wKGV2ZW50LCBjb21wKSB7CiAgICAgIGxldCBpdGVtID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb21wKSk7CiAgICAgIGlmKCFpdGVtKSByZXR1cm47CiAgICAgIHRoaXMuaW5pdENvbXBTdGF0ZSgpOwogICAgICBpdGVtLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgaXRlbS5tdWx0aXBsZUFjdGl2ZUJvb2w9ZmFsc2U7CiAgICAgIGxldCB7d2lkdGgsIGhlaWdodCwgYm9yZGVyUmFkaXVzfSA9IGl0ZW0uZGVmU3R5bGU7CiAgICAgIGxldCB7Y2xpZW50WCAsIGNsaWVudFl9ID0gZXZlbnQ7CiAgICAgIGxldCBfc3R5bGUgPSB7CiAgICAgICAgICB3aWR0aDp3aWR0aCB8fCAxMDAsCiAgICAgICAgICBoZWlnaHQ6aGVpZ2h0IHx8IDEwMCwKICAgICAgICAgIHRvcDogY2xpZW50WSB8fDEwMCwKICAgICAgICAgIGxlZnQ6Y2xpZW50WCB8fCAxMDAsCiAgICAgICAgICBkcmFnX3N0YXJ0X3g6IDAsIC8v5ouW5ou955u45a+5CiAgICAgICAgICBkcmFnX3N0YXJ0X3kgOjAsCiAgICAgICAgICBwb3NpdGlvbjonYWJzb2x1dGUnLAogICAgICAgICAgaXNBcHBseVNoYWRvdzondHJ1ZScsCiAgICAgICAgICBib3JkZXJSYWRpdXM6Ym9yZGVyUmFkaXVzIHx8IDAKICAgICAgfQogICAgICBpdGVtLnN0eWxlID0gX3N0eWxlOwogICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5wdXNoKGl0ZW0pOwogICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoIC0xOwogICAgfSwKICAgIGluaXRDb21wb25lbnRTdGF0ZShjdXJyZW50LCBldmVudCkgewogICAgICBpZihjdXJyZW50ID09PSB1bmRlZmluZWQgfHwgY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSAtMSkgcmV0dXJuOwogICAgICBpZihldmVudCAmJiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkgJiYgZXZlbnQuYnV0dG9uID09PSAwICkgewogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2N1cnJlbnRdLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgaWYodGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA+IC0xKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gLTE7CiAgICAgICAgfQoKICAgICAgICAvLyDlpJrpgInmk43kvZznvJPlrZjmlbDnu4QKICAgICAgICBjb25zdCBfbXVsdGlwQWN0aXZlSW5kZXggPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIuaW5kZXhPZih0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XSk7CiAgICAgICAgaWYoIF9tdWx0aXBBY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5wdXNoKHRoaXMuZWRyYXdDb21wb25lbnRzW2N1cnJlbnRdKQogICAgICAgIH0KCiAgICAgICAgaWYodGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0ubXVsdGlwbGVBY3RpdmVCb29sKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XS5tdWx0aXBsZUFjdGl2ZUJvb2wgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zcGxpY2UoX211bHRpcEFjdGl2ZUluZGV4LCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0ubXVsdGlwbGVBY3RpdmVCb29sID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH1lbHNlIHsKICAgICAgICB0aGlzLmluaXRDb21wU3RhdGUoKTsgICAgIAogICAgICAgIHRoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXggPSBjdXJyZW50OwogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2N1cnJlbnRdLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgfQoKICAgIH0sCiAgICAvLyDliJ3lp4vljJbnlLvluIPlhoXnu4Tku7bnirbmgIEKICAgIGluaXRDb21wU3RhdGUoKSB7CiAgICAgIGxldCBsZW4gPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGg7CiAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwogICAgICBmb3IobGV0IGk9MDtpPGxlbjtpKyspIHsKICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tpXS5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLm11bHRpcGxlQWN0aXZlQm9vbCA9IGZhbHNlOwogICAgICB9CiAgICAgIHRoaXMuZVN0YXRlcy5jb3B5QnlLZXlCb29sID0gZmFsc2U7CiAgICB9LAogICAgLy8g57uE5Lu25ouW5ou977yaY3RybGtleSA9PT0gdHJ1ZSDlpITnkIblpJrpgIkKICAgIGRyYWdDdXJyZW50Q29tcChldmVudCwgY29tcCwgc3RhdGUsIGN1cnJlbnRJbmRleCwgY2FudmVzUmVjdCkgewogICAgICBpZihldmVudCAmJiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkgICl7CiAgICAgICAgY29uc29sZS5sb2coJ+WkmumAieWkhOeQhicpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wgPSBmYWxzZTsKICAgICAgICBpZihzdGF0ZSA9PT0gJ3N0YXJ0JykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IGN1cnJlbnRJbmRleDsKICAgICAgICAgIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94ID0gZXZlbnQuY2xpZW50WCAtIGNvbXAuc3R5bGUubGVmdDsKICAgICAgICAgIGNvbXAuc3R5bGUuZHJhZ19zdGFydF95ID0gZXZlbnQuY2xpZW50WSAtIGNvbXAuc3R5bGUudG9wOwogICAgICAgIH1lbHNlIGlmKHN0YXRlID09PSAnZHJhZycpewogICAgICAgICAgbGV0IF9sZWZ0ID0gZXZlbnQuY2xpZW50WCAtIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94OyAKICAgICAgICAgIGxldCBfdG9wID0gZXZlbnQuY2xpZW50WSAtIGNvbXAuc3R5bGUuZHJhZ19zdGFydF95OwogICAgICAgICAgaWYoX2xlZnQgPDAgfHwgX3RvcCA8IDApIHJldHVybjsKICAgICAgICAgIGxldCBsZWZ0ID0gKF9sZWZ0IC0gY2FudmVzUmVjdC54KSA+PSAwID8gX2xlZnQgOiBjYW52ZXNSZWN0Lng7IC8vIOWkhOeQhmxlZnTnvJbovpHpl67popgKICAgICAgICAgIGxldCB0b3AgPSAoX3RvcCAtIGNhbnZlc1JlY3QueSkgPj0gMCA/IF90b3AgOiBjYW52ZXNSZWN0Lnk7IC8vIOWkhOeQhnRvcOi+ueeVjOmXrumimAogICAgICAgICAgY29tcC5zdHlsZS5sZWZ0ID0gbGVmdDsKICAgICAgICAgIGNvbXAuc3R5bGUudG9wID0gdG9wOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOe7hOS7tuWIoOmZpAogICAgZGVsQ29tcChpbmRleCwgc3RhdGUpIHsKICAgICAgaWYoc3RhdGUgPT09ICdtdWx0aXBsZURlbCcpIHsKICAgICAgICBsZXQgbGVuID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwogICAgICAgIGZvcihsZXQgaT1sZW47aS0tO2kgPjApIHsKICAgICAgICAgIGxldCBtdWx0aXBCb29sID0gdGhpcy5lZHJhd0NvbXBvbmVudHNbaV0ubXVsdGlwbGVBY3RpdmVCb29sOwogICAgICAgICAgaWYobXVsdGlwQm9vbCkgewogICAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5zcGxpY2UoaSwxKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZih0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID4gLTEgJiZ0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5zcGxpY2UodGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCwxKQogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IC0xOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOmUruebmOaLt+i0neS6i+S7tgogICAga2F5ZG93bkZ1bihldmVudCkgewogICAgICBpZih0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID09PSAtMSkgcmV0dXJuOyAKICAgICAgaWYoZXZlbnQua2V5ID09PSAnYycpIHsKICAgICAgICB0aGlzLmVTdGF0ZXMuY29weUJ5S2V5Qm9vbCA9IHRydWU7CiAgICAgIH1lbHNlIGlmKHRoaXMuZVN0YXRlcy5jb3B5QnlLZXlCb29sICYmIGV2ZW50LmtleSA9PT0gJ3YnKSB7CiAgICAgICAgdGhpcy5jb3B5Q3VycmVudENvbXAoKTsKICAgICAgfQogICAgICBpZihldmVudC5rZXkgPT09ICdEZWxldGUnIHx8IHRoaXMuaXNNYWMoKSAmJiBldmVudC5rZXkgPT09ICdCYWNrc3BhY2UnKSAgewogICAgICAgIHRoaXMuZGVsQ29tcCgpOwogICAgICB9CiAgICB9LAogICAgLy8g5aSa6YCJ5LqL5Lu2CiAgICBtb3VzZWRvd25GdW4oZXZlbnQpIHsKICAgICAgaWYoKCFldmVudC5jdHJsS2V5IHx8ICFldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkgJiYgZXZlbnQuYnV0dG9uID09PSAwIAogICAgICAgICYmIGV2ZW50LnRhcmdldC5pZD09PSdjYW52YXMnIAogICAgICAgICYmICFldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb21wLWVsZW1lbnQnKSkgewogICAgICAgIHRoaXMuZVN0YXRlcy5jb3B5QnlLZXlCb29sID0gZmFsc2U7CiAgICAgICAgdGhpcy5pbml0Q29tcFN0YXRlKCk7CiAgICAgIH0gCiAgICB9LAogICAgLy8g5Yib5bu65b2T5YmN57uE5Lu2CiAgICBjb3B5Q3VycmVudENvbXA6ZnVuY3Rpb24oKSB7CiAgICAgIGxldCBfY3VyckNvbXAgPSB0aGlzLmVkcmF3Q29tcG9uZW50c1t0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4XTsKICAgICAgaWYoIV9jdXJyQ29tcCkgcmV0dXJuOwogICAgICBfY3VyckNvbXAuaXNBY3RpdmUgPSBmYWxzZTsKICAgICAgbGV0IF9jb3B5ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfY3VyckNvbXApKTsKICAgICAgbGV0IF9zdHlsZSA9IF9jdXJyQ29tcC5zdHlsZTsKICAgICAgX2NvcHkuc3R5bGUudG9wID0gX3N0eWxlLmhlaWdodCArIF9zdHlsZS50b3AgKyAxOwogICAgICBfY29weS5pc0FjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzLnB1c2goX2NvcHkpOwogICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoIC0gMTsgLy/mm7TmlrDmv4DmtLvnu4Tku7bnmoTkuIvmoIcKICAgIH0sCiAgICAvLyDlpJrpgInmk43kvZw65Y+N6YCJL+a4heepuuWkmumAiS/lsZ7mgKflupTnlKgKICAgIHNldE11bHRpcGxlU3RhdGU6ZnVuY3Rpb24oc3RhdGUsIHZhbHVlKSB7CiAgICAgIGlmKHN0YXRlID09PSAncmVTZWwnKSB7CiAgICAgICAgbGV0IGxlbiA9IHRoaXMuZWRyYXdDb21wb25lbnRzLmxlbmd0aDsKICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIgPSBbXTsKICAgICAgICBmb3IobGV0IGk9bGVuO2ktLTtpID4wKSB7CiAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZWRyYXdDb21wb25lbnRzW2ldOwogICAgICAgICAgaWYoIWl0ZW0ubXVsdGlwbGVBY3RpdmVCb29sKSB7ICAKICAgICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLnB1c2goaXRlbSk7CiAgICAgICAgICB9CiAgICAgICAgICBpdGVtLm11bHRpcGxlQWN0aXZlQm9vbCA9ICFpdGVtLm11bHRpcGxlQWN0aXZlQm9vbDsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZihzdGF0ZSA9PT0gJ2NsZWFyJyl7CiAgICAgICAgbGV0IGxlbiA9IHRoaXMuZWRyYXdDb21wb25lbnRzLmxlbmd0aDsKICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIgPSBbXTsKICAgICAgICBmb3IobGV0IGk9bGVuO2ktLTtpID4wKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tpXS5tdWx0aXBsZUFjdGl2ZUJvb2wgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH1lbHNlIGlmKFsnaXNBcHBseVNoYWRvdycsICdib3JkZXJSYWRpdXMnXS5pbmRleE9mKHN0YXRlKSA+IC0xKSB7CiAgICAgICAgbGV0IGxlbiA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5sZW5ndGg7CiAgICAgICAgZm9yKGxldCBpPWxlbjtpLS07aSA+MCkgewogICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyW2ldLnN0eWxlW3N0YXRlXSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfWVsc2UgaWYoc3RhdGUgPT09ICdhbGlnbicpIHsKICAgICAgICBzd2l0Y2godmFsdWUpIHsKICAgICAgICAgIGNhc2UgJ3QnIDoKICAgICAgICAgICAgdGhpcy5tdWx0aXBBcnJheSgndG9wJyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnbCcgOgogICAgICAgICAgICB0aGlzLm11bHRpcEFycmF5KCdsZWZ0Jyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnYicgOgogICAgICAgICAgICB0aGlzLm11bHRpcEFycmF5KCdib3R0b20nKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdyJyA6CiAgICAgICAgICAgIHRoaXMubXVsdGlwQXJyYXkoJ3JpZ2h0Jyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8g5Yig6Zmk5aSa6YCJ5YWD57SgCiAgICBkZWxNdWx0aXBDb21wKGNvbXAsIGluZGV4KSB7CiAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zcGxpY2UoaW5kZXgsIDEpOwogICAgICBsZXQgX2luZGV4ID0gdGhpcy5lZHJhd0NvbXBvbmVudHMuaW5kZXhPZihjb21wKTsKICAgICAgaWYoX2luZGV4ID4gLTEpIHsKICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tfaW5kZXhdLm11bHRpcGxlQWN0aXZlQm9vbCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgY2hhbmdlQ29uZmlnKHN0YXRlLCB2YWx1ZSl7CiAgICAgIGlmKCF0aGlzLmNvbmZpZ3Nbc3RhdGVdKSByZXR1cm47CiAgICAgIHRoaXMuY29uZmlnc1tzdGF0ZV0gPSB2YWx1ZTsKICAgIH0sCiAgICBtdWx0aXBBcnJheShwYXJhbSkgewogICAgICBsZXQgbGlzdCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5lZHJhd0NvbXBvbmVudHMpKTsKICAgICAgbGlzdC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICByZXR1cm4gWyd0b3AnLCAnbGVmdCddLmluZGV4T2YocGFyYW0pID4gLTEgPyBhLnN0eWxlW3BhcmFtXSAtIGIuc3R5bGVbcGFyYW1dOgogICAgICAgICAgcGFyYW0gPT09ICdib3R0b20nID8gIGIuc3R5bGUudG9wICsgYi5zdHlsZS5oZWlnaHQgLSAoYS5zdHlsZS50b3AgKyBhLnN0eWxlLmhlaWdodCkgOgogICAgICAgICAgYi5zdHlsZS5sZWZ0ICsgYi5zdHlsZS53aWR0aCAtIChhLnN0eWxlLmxlZnQgKyBhLnN0eWxlLndpZHRoKSAKICAgICAgfSk7CiAgICAgIGxldCBsZW4gPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGg7CiAgICAgIGxldCByZXNPYmogPSBsaXN0WzBdOwogICAgICBpZihbJ3RvcCcsICdsZWZ0J10uaW5kZXhPZihwYXJhbSkgPiAtMSkgewogICAgICAgIGZvcihsZXQgaT0wO2k8bGVuO2krKykgewogICAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbaV0uc3R5bGVbcGFyYW1dID0gcmVzT2JqLnN0eWxlW3BhcmFtXTsKICAgICAgICB9CiAgICAgIH1lbHNlIGlmKHBhcmFtID09PSAnYm90dG9tJykgewogICAgICAgIGxldCBfYm90dG9tID0gcmVzT2JqLnN0eWxlLnRvcCArIHJlc09iai5zdHlsZS5oZWlnaHQ7CiAgICAgICAgZm9yKGxldCBpPTA7aTxsZW47aSsrKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tpXS5zdHlsZS50b3AgPSBfYm90dG9tIC0gdGhpcy5lZHJhd0NvbXBvbmVudHNbaV0uc3R5bGUuaGVpZ2h0OwogICAgICAgIH0KICAgICAgfWVsc2UgaWYocGFyYW0gPT09ICdyaWdodCcpIHsKICAgICAgICBjb25zb2xlLmxvZyhwYXJhbSwgcmVzT2JqKQogICAgICAgIGxldCBfcmlnaHQgPSByZXNPYmouc3R5bGUubGVmdCArIHJlc09iai5zdHlsZS53aWR0aDsKICAgICAgICBmb3IobGV0IGk9MDtpPGxlbjtpKyspIHsKICAgICAgICAgIGNvbnNvbGUubG9nKF9yaWdodCkKICAgICAgICAgIGNvbnNvbGUubG9nKF9yaWdodCAtIHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLnN0eWxlLndpZHRoKQogICAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbaV0uc3R5bGUubGVmdCA9IF9yaWdodCAtIHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLnN0eWxlLndpZHRoOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGlzTWFjOmZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gL21hY2ludG9zaHxtYWMgb3MgeC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["editor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editor.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"editor\">\n    <editor-comps \n      v-bind:elements=\"edrawComponents\"\n      v-on:initCompsState=\"initComponentState\" \n      v-on:selectComp=\"selectComp\"></editor-comps>\n    <editor-canvas \n      v-bind:configs=\"configs\"\n      v-bind:edrawComps=\"edrawComponents\"\n      v-bind:currentActiveIndex=\"eStates.currentActiveIndex\"\n      v-bind:multipleActiveBool=\"eStates.multipleActiveBool\"\n      v-on:initCompsState=\"initComponentState\" \n      v-on:dragComp=\"dragCurrentComp\"></editor-canvas>\n    <editor-settings\n      v-bind:currentActiveIndex=\"eStates.currentActiveIndex\"\n      v-bind:currentElement=\"edrawComponents[eStates.currentActiveIndex]\"\n      v-bind:multipleActiveArr=\"eStates.multipleActiveArr\"\n      v-bind:configs=\"configs\"\n      v-on:delComp=\"delComp\"\n      v-on:delMultipComp=\"delMultipComp\"\n      v-on:setMultipleState=\"setMultipleState\"\n      v-on:changeConfig=\"changeConfig\"></editor-settings>\n    <editor-help>\n      \n    </editor-help>\n  </div>\n</template>\n\n<script>\nimport EditorComps from './editor-comps';\nimport EditorCanvas from './editor-canvas';\nimport EditorSettings from './editor-settings';\nimport EditorHelp from './editor-help'\n\nexport default {\n  name: 'Editor',\n  created:function() {\n    document.addEventListener('keydown', this.kaydownFun);\n    document.addEventListener('mousedown', this.mousedownFun)\n  },\n  data(){\n     return {\n        eStates:{\n          currentActiveIndex:-1,\n          copyByKeyBool:false,\n          multipleActiveArr:[],\n        },\n        edrawComponents:[],\n        configs:{\n          bg:\"grid\",\n          pageName:'底图',\n          spacing:10,\n          dowloadImgType:'png'\n        }\n     }\n  },\n  components: {\n    'editor-comps':EditorComps,\n    'editor-canvas':EditorCanvas,\n    'editor-settings':EditorSettings,\n    'editor-help':EditorHelp\n  },\n  methods: {\n    \n    // 组件选择\n    selectComp(event, comp) {\n      let item = JSON.parse(JSON.stringify(comp));\n      if(!item) return;\n      this.initCompState();\n      item.isActive = true;\n      item.multipleActiveBool=false;\n      let {width, height, borderRadius} = item.defStyle;\n      let {clientX , clientY} = event;\n      let _style = {\n          width:width || 100,\n          height:height || 100,\n          top: clientY ||100,\n          left:clientX || 100,\n          drag_start_x: 0, //拖拽相对\n          drag_start_y :0,\n          position:'absolute',\n          isApplyShadow:'true',\n          borderRadius:borderRadius || 0\n      }\n      item.style = _style;\n      this.edrawComponents.push(item);\n      this.eStates.currentActiveIndex = this.edrawComponents.length -1;\n    },\n    initComponentState(current, event) {\n      if(current === undefined || current === null || current === -1) return;\n      if(event && (event.ctrlKey || event.metaKey && this.isMac()) && event.button === 0 ) {\n        this.edrawComponents[current].isActive = false;\n        if(this.eStates.currentActiveIndex > -1) {\n          this.eStates.currentActiveIndex = -1;\n        }\n\n        // 多选操作缓存数组\n        const _multipActiveIndex = this.eStates.multipleActiveArr.indexOf(this.edrawComponents[current]);\n        if( _multipActiveIndex === -1) {\n          this.eStates.multipleActiveArr.push(this.edrawComponents[current])\n        }\n\n        if(this.edrawComponents[current].multipleActiveBool) {\n          this.edrawComponents[current].multipleActiveBool = false;\n          this.eStates.multipleActiveArr.splice(_multipActiveIndex, 1);\n        } else {\n          this.edrawComponents[current].multipleActiveBool = true;\n        }\n      }else {\n        this.initCompState();     \n        this.eStates.currentActiveIndex = current;\n        this.edrawComponents[current].isActive = true;\n      }\n\n    },\n    // 初始化画布内组件状态\n    initCompState() {\n      let len = this.edrawComponents.length;\n      this.eStates.multipleActiveArr = [];\n      for(let i=0;i<len;i++) {\n        this.edrawComponents[i].isActive = false;\n        this.edrawComponents[i].multipleActiveBool = false;\n      }\n      this.eStates.copyByKeyBool = false;\n    },\n    // 组件拖拽：ctrlkey === true 处理多选\n    dragCurrentComp(event, comp, state, currentIndex, canvesRect) {\n      if(event && (event.ctrlKey || event.metaKey && this.isMac())  ){\n        console.log('多选处理')\n      } else {\n        this.eStates.copyByKeyBool = false;\n        if(state === 'start') {\n          this.eStates.currentActiveIndex = currentIndex;\n          comp.style.drag_start_x = event.clientX - comp.style.left;\n          comp.style.drag_start_y = event.clientY - comp.style.top;\n        }else if(state === 'drag'){\n          let _left = event.clientX - comp.style.drag_start_x; \n          let _top = event.clientY - comp.style.drag_start_y;\n          if(_left <0 || _top < 0) return;\n          let left = (_left - canvesRect.x) >= 0 ? _left : canvesRect.x; // 处理left编辑问题\n          let top = (_top - canvesRect.y) >= 0 ? _top : canvesRect.y; // 处理top边界问题\n          comp.style.left = left;\n          comp.style.top = top;\n        }\n      }\n    },\n    // 组件删除\n    delComp(index, state) {\n      if(state === 'multipleDel') {\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          let multipBool = this.edrawComponents[i].multipleActiveBool;\n          if(multipBool) {\n            this.edrawComponents.splice(i,1)\n          }\n        }\n      } else {\n        if(this.eStates.currentActiveIndex > -1 &&this.edrawComponents.length > 0) {\n          this.edrawComponents.splice(this.eStates.currentActiveIndex,1)\n          this.eStates.currentActiveIndex = -1;\n        }\n      }\n    },\n    // 键盘拷贝事件\n    kaydownFun(event) {\n      if(this.eStates.currentActiveIndex === -1) return; \n      if(event.key === 'c') {\n        this.eStates.copyByKeyBool = true;\n      }else if(this.eStates.copyByKeyBool && event.key === 'v') {\n        this.copyCurrentComp();\n      }\n      if(event.key === 'Delete' || this.isMac() && event.key === 'Backspace')  {\n        this.delComp();\n      }\n    },\n    // 多选事件\n    mousedownFun(event) {\n      if((!event.ctrlKey || !event.metaKey && this.isMac()) && event.button === 0 \n        && event.target.id==='canvas' \n        && !event.target.classList.contains('comp-element')) {\n        this.eStates.copyByKeyBool = false;\n        this.initCompState();\n      } \n    },\n    // 创建当前组件\n    copyCurrentComp:function() {\n      let _currComp = this.edrawComponents[this.eStates.currentActiveIndex];\n      if(!_currComp) return;\n      _currComp.isActive = false;\n      let _copy = JSON.parse(JSON.stringify(_currComp));\n      let _style = _currComp.style;\n      _copy.style.top = _style.height + _style.top + 1;\n      _copy.isActive = true;\n      this.edrawComponents.push(_copy);\n      this.eStates.currentActiveIndex = this.edrawComponents.length - 1; //更新激活组件的下标\n    },\n    // 多选操作:反选/清空多选/属性应用\n    setMultipleState:function(state, value) {\n      if(state === 'reSel') {\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          let item = this.edrawComponents[i];\n          if(!item.multipleActiveBool) {  \n            this.eStates.multipleActiveArr.push(item);\n          }\n          item.multipleActiveBool = !item.multipleActiveBool;\n        }\n      } else if(state === 'clear'){\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          this.edrawComponents[i].multipleActiveBool = false;\n        }\n      }else if(['isApplyShadow', 'borderRadius'].indexOf(state) > -1) {\n        let len = this.eStates.multipleActiveArr.length;\n        for(let i=len;i--;i >0) {\n          this.eStates.multipleActiveArr[i].style[state] = value;\n        }\n      }else if(state === 'align') {\n        switch(value) {\n          case 't' :\n            this.multipArray('top');\n            break;\n          case 'l' :\n            this.multipArray('left');\n            break;\n          case 'b' :\n            this.multipArray('bottom');\n            break;\n          case 'r' :\n            this.multipArray('right');\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    // 删除多选元素\n    delMultipComp(comp, index) {\n      this.eStates.multipleActiveArr.splice(index, 1);\n      let _index = this.edrawComponents.indexOf(comp);\n      if(_index > -1) {\n        this.edrawComponents[_index].multipleActiveBool = false;\n      }\n    },\n    changeConfig(state, value){\n      if(!this.configs[state]) return;\n      this.configs[state] = value;\n    },\n    multipArray(param) {\n      let list = JSON.parse(JSON.stringify(this.edrawComponents));\n      list.sort(function(a, b) {\n        return ['top', 'left'].indexOf(param) > -1 ? a.style[param] - b.style[param]:\n          param === 'bottom' ?  b.style.top + b.style.height - (a.style.top + a.style.height) :\n          b.style.left + b.style.width - (a.style.left + a.style.width) \n      });\n      let len = this.edrawComponents.length;\n      let resObj = list[0];\n      if(['top', 'left'].indexOf(param) > -1) {\n        for(let i=0;i<len;i++) {\n          this.edrawComponents[i].style[param] = resObj.style[param];\n        }\n      }else if(param === 'bottom') {\n        let _bottom = resObj.style.top + resObj.style.height;\n        for(let i=0;i<len;i++) {\n          this.edrawComponents[i].style.top = _bottom - this.edrawComponents[i].style.height;\n        }\n      }else if(param === 'right') {\n        console.log(param, resObj)\n        let _right = resObj.style.left + resObj.style.width;\n        for(let i=0;i<len;i++) {\n          console.log(_right)\n          console.log(_right - this.edrawComponents[i].style.width)\n          this.edrawComponents[i].style.left = _right - this.edrawComponents[i].style.width;\n        }\n      }\n    },\n    isMac:function() {\n      return /macintosh|mac os x/i.test(navigator.userAgent)\n    }\n  }\n}\n</script>\n\n<style>\n\n#editor {\n  margin-top: 60px;\n  padding: 0;\n  position: relative;\n  color: #2c3e50;\n  display: grid;\n  grid-template-columns: 205px auto 205px;\n}\n</style>\n"]}]}