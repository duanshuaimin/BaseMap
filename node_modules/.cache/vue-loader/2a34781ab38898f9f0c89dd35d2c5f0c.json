{"remainingRequest":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangma/Desktop/workspace/BaseMap/src/components/editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangma/Desktop/workspace/BaseMap/src/components/editor.vue","mtime":1588847381765},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangma/Desktop/workspace/BaseMap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFZGl0b3JDb21wcyBmcm9tICcuL2VkaXRvci1jb21wcyc7CmltcG9ydCBFZGl0b3JDYW52YXMgZnJvbSAnLi9lZGl0b3ItY2FudmFzJzsKaW1wb3J0IEVkaXRvclNldHRpbmdzIGZyb20gJy4vZWRpdG9yLXNldHRpbmdzJzsKaW1wb3J0IEVkaXRvckhlbHAgZnJvbSAnLi9lZGl0b3ItaGVscCcKaW1wb3J0IGh0bWwyY2FudmFzIGZyb20gJ2h0bWwyY2FudmFzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRWRpdG9yJywKICBjcmVhdGVkOmZ1bmN0aW9uKCkgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMua2F5ZG93bkZ1bik7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm1vdXNlZG93bkZ1bikKICB9LAogIGRhdGEoKXsKICAgICByZXR1cm4gewogICAgICAgIGVTdGF0ZXM6ewogICAgICAgICAgY3VycmVudEFjdGl2ZUluZGV4Oi0xLAogICAgICAgICAgY29weUJ5S2V5Qm9vbDpmYWxzZSwKICAgICAgICAgIG11bHRpcGxlQWN0aXZlQXJyOltdLAogICAgICAgIH0sCiAgICAgICAgZWRyYXdDb21wb25lbnRzOltdLAogICAgICAgIGNvbmZpZ3M6ewogICAgICAgICAgYmc6ImdyaWQiLAogICAgICAgICAgcGFnZU5hbWU6J+W6leWbvicsCiAgICAgICAgICBzcGFjaW5nOjEwLAogICAgICAgICAgc2NhbGU6MSwKICAgICAgICAgIElzb21ldHJpY19yb3c6MTAsCiAgICAgICAgICBJc29tZXRyaWNfY29sdToxMCwKICAgICAgICAgIGRvd2xvYWRJbWdUeXBlOidwbmcnLAogICAgICAgICAgYmdBbGxCb29sOmZhbHNlLAogICAgICAgICAgd2luZG93X3c6MTkyMCwKICAgICAgICAgIHdpbmRvd19oOjkwMAogICAgICAgIH0KICAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICAnZWRpdG9yLWNvbXBzJzpFZGl0b3JDb21wcywKICAgICdlZGl0b3ItY2FudmFzJzpFZGl0b3JDYW52YXMsCiAgICAnZWRpdG9yLXNldHRpbmdzJzpFZGl0b3JTZXR0aW5ncywKICAgICdlZGl0b3ItaGVscCc6RWRpdG9ySGVscAogIH0sCiAgbWV0aG9kczogewogICAgZG93bmxvYWQ6ZnVuY3Rpb24oKSB7CiAgICAgIGh0bWwyY2FudmFzKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKSx7CiAgICAgICAgbGV0dGVyUmVuZGVyaW5nOiB0cnVlLCBhbGxvd1RhaW50OiBmYWxzZSwgdXNlQ09SUzogdHJ1ZSwgCiAgICAgICAgc2NhbGU6IDE5MjAqMi93aW5kb3cuaW5uZXJXaWR0aCwgCiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmVkJyAKICAgICAgfSkudGhlbihjYW52YXMgPT4gewogICAgICAgIHRoaXMuc2F2ZUFzKCBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSkKICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coIkVSUk9SIFNBVklORyBGRVNUSVZBTCBJTUFHRSIsIGVycm9yKQogICAgICB9KTsKICAgIH0sCiAgICBzYXZlQXM6ZnVuY3Rpb24oaW1nKSB7CiAgICAgIGxldCBfZG9tID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICBfZG9tLmhyZWYgPSBpbWcKICAgICAgICBfZG9tLmRhdGFzZXQuZG93bmxvYWR1cmwgPSBbJ2ltYWdlL3BuZycsICdJTUdfRE9XTkxPQURfTkFNRScsIF9kb20uaHJlZl0uam9pbignOicpOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoX2RvbSk7CiAgICAgICAgX2RvbS5jbGljaygpOwogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoX2RvbSk7CiAgICB9LAogICAgLy8g57uE5Lu26YCJ5oupCiAgICBzZWxlY3RDb21wKGV2ZW50LCBjb21wKSB7CiAgICAgIGxldCBpdGVtID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb21wKSk7CiAgICAgIGlmKCFpdGVtKSByZXR1cm47CiAgICAgIHRoaXMuaW5pdENvbXBTdGF0ZSgpOwogICAgICBpdGVtLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgaXRlbS5tdWx0aXBsZUFjdGl2ZUJvb2w9ZmFsc2U7CiAgICAgIGxldCB7d2lkdGgsIGhlaWdodCwgYm9yZGVyUmFkaXVzfSA9IGl0ZW0uZGVmU3R5bGU7CiAgICAgIGxldCB7Y2xpZW50WCAsIGNsaWVudFl9ID0gZXZlbnQ7CiAgICAgIGxldCBfc3R5bGUgPSB7CiAgICAgICAgICB3aWR0aDp3aWR0aCB8fCAxMDAsCiAgICAgICAgICBoZWlnaHQ6aGVpZ2h0IHx8IDEwMCwKICAgICAgICAgIHRvcDogY2xpZW50WSB8fDEwMCwKICAgICAgICAgIGxlZnQ6Y2xpZW50WCB8fCAxMDAsCiAgICAgICAgICBkcmFnX3N0YXJ0X3g6IDAsIC8v5ouW5ou955u45a+5CiAgICAgICAgICBkcmFnX3N0YXJ0X3kgOjAsCiAgICAgICAgICBwb3NpdGlvbjonYWJzb2x1dGUnLAogICAgICAgICAgaXNBcHBseVNoYWRvdzondHJ1ZScsCiAgICAgICAgICBib3JkZXJSYWRpdXM6Ym9yZGVyUmFkaXVzIHx8IDAKICAgICAgfQogICAgICBpdGVtLnN0eWxlID0gX3N0eWxlOwogICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5wdXNoKGl0ZW0pOwogICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoIC0xOwogICAgfSwKICAgIGluaXRDb21wb25lbnRTdGF0ZShjdXJyZW50LCBldmVudCkgewogICAgICBpZihjdXJyZW50ID09PSB1bmRlZmluZWQgfHwgY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSAtMSkgcmV0dXJuOwogICAgICBpZihldmVudCAmJiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkgJiYgZXZlbnQuYnV0dG9uID09PSAwICkgewogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2N1cnJlbnRdLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgaWYodGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA+IC0xKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID0gLTE7CiAgICAgICAgfQoKICAgICAgICAvLyDlpJrpgInmk43kvZznvJPlrZjmlbDnu4QKICAgICAgICBjb25zdCBfbXVsdGlwQWN0aXZlSW5kZXggPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIuaW5kZXhPZih0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XSk7CiAgICAgICAgaWYoIF9tdWx0aXBBY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5wdXNoKHRoaXMuZWRyYXdDb21wb25lbnRzW2N1cnJlbnRdKQogICAgICAgIH0KCiAgICAgICAgaWYodGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0ubXVsdGlwbGVBY3RpdmVCb29sKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tjdXJyZW50XS5tdWx0aXBsZUFjdGl2ZUJvb2wgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zcGxpY2UoX211bHRpcEFjdGl2ZUluZGV4LCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lZHJhd0NvbXBvbmVudHNbY3VycmVudF0ubXVsdGlwbGVBY3RpdmVCb29sID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH1lbHNlIHsKICAgICAgICB0aGlzLmluaXRDb21wU3RhdGUoKTsgICAgIAogICAgICAgIHRoaXMuZVN0YXRlcy5jdXJyZW50QWN0aXZlSW5kZXggPSBjdXJyZW50OwogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2N1cnJlbnRdLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgfQoKICAgIH0sCiAgICAvLyDliJ3lp4vljJbnlLvluIPlhoXnu4Tku7bnirbmgIEKICAgIGluaXRDb21wU3RhdGUoKSB7CiAgICAgIGxldCBsZW4gPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGg7CiAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwogICAgICBmb3IobGV0IGk9MDtpPGxlbjtpKyspIHsKICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50c1tpXS5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLm11bHRpcGxlQWN0aXZlQm9vbCA9IGZhbHNlOwogICAgICB9CiAgICAgIHRoaXMuZVN0YXRlcy5jb3B5QnlLZXlCb29sID0gZmFsc2U7CiAgICB9LAogICAgLy8g57uE5Lu25ouW5ou977yaY3RybGtleSA9PT0gdHJ1ZSDlpITnkIblpJrpgIkKICAgIGRyYWdDdXJyZW50Q29tcChldmVudCwgY29tcCwgc3RhdGUsIGN1cnJlbnRJbmRleCwgY2FudmVzUmVjdCkgewogICAgICBpZihldmVudCAmJiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5ICYmIHRoaXMuaXNNYWMoKSkgICl7CiAgICAgICAgY29uc29sZS5sb2coJ+WkmumAieWkhOeQhicpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pbml0Q29tcFN0YXRlKCk7CiAgICAgICAgdGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wgPSBmYWxzZTsKICAgICAgICBpZihzdGF0ZSA9PT0gJ3N0YXJ0JykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IGN1cnJlbnRJbmRleDsKICAgICAgICAgIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94ID0gZXZlbnQuY2xpZW50WCAtIGNvbXAuc3R5bGUubGVmdDsKICAgICAgICAgIGNvbXAuc3R5bGUuZHJhZ19zdGFydF95ID0gZXZlbnQuY2xpZW50WSAtIGNvbXAuc3R5bGUudG9wOwogICAgICAgIH1lbHNlIGlmKHN0YXRlID09PSAnZHJhZycpewogICAgICAgICAgbGV0IF9sZWZ0ID0gZXZlbnQuY2xpZW50WCAtIGNvbXAuc3R5bGUuZHJhZ19zdGFydF94OyAKICAgICAgICAgIGxldCBfdG9wID0gZXZlbnQuY2xpZW50WSAtIGNvbXAuc3R5bGUuZHJhZ19zdGFydF95OwogICAgICAgICAgaWYoX2xlZnQgPDAgfHwgX3RvcCA8IDApIHJldHVybjsKICAgICAgICAgIGxldCBsZWZ0ID0gKF9sZWZ0IC0gY2FudmVzUmVjdC54KSA+PSAwID8gX2xlZnQgOiBjYW52ZXNSZWN0Lng7IC8vIOWkhOeQhmxlZnTnvJbovpHpl67popgKICAgICAgICAgIGxldCB0b3AgPSAoX3RvcCAtIGNhbnZlc1JlY3QueSkgPj0gMCA/IF90b3AgOiBjYW52ZXNSZWN0Lnk7IC8vIOWkhOeQhnRvcOi+ueeVjOmXrumimAogICAgICAgICAgY29tcC5zdHlsZS5sZWZ0ID0gbGVmdDsKICAgICAgICAgIGNvbXAuc3R5bGUudG9wID0gdG9wOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOe7hOS7tuWIoOmZpAogICAgZGVsQ29tcChpbmRleCwgc3RhdGUpIHsKICAgICAgaWYoc3RhdGUgPT09ICdtdWx0aXBsZURlbCcpIHsKICAgICAgICBsZXQgbGVuID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwogICAgICAgIGZvcihsZXQgaT1sZW47aS0tO2kgPjApIHsKICAgICAgICAgIGxldCBtdWx0aXBCb29sID0gdGhpcy5lZHJhd0NvbXBvbmVudHNbaV0ubXVsdGlwbGVBY3RpdmVCb29sOwogICAgICAgICAgaWYobXVsdGlwQm9vbCkgewogICAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5zcGxpY2UoaSwxKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZih0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID4gLTEgJiZ0aGlzLmVkcmF3Q29tcG9uZW50cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5zcGxpY2UodGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCwxKQogICAgICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IC0xOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOmUruebmOS6i+S7tgogICAga2F5ZG93bkZ1bihldmVudCkgewogICAgICBpZihldmVudC5rZXkgPT09ICdjJykgewogICAgICAgIHRoaXMuZVN0YXRlcy5jb3B5QnlLZXlCb29sID0gdHJ1ZTsKICAgICAgfWVsc2UgaWYodGhpcy5lU3RhdGVzLmNvcHlCeUtleUJvb2wgJiYgZXZlbnQua2V5ID09PSAndicpIHsKICAgICAgICB0aGlzLmNvcHlDdXJyZW50Q29tcCgpOwogICAgICB9ZWxzZSB7CiAgICAgICAgaWYoWydBcnJvd1VwJywnQXJyb3dEb3duJywnQXJyb3dMZWZ0JywiQXJyb3dSaWdodCJdLmluZGV4T2YoZXZlbnRbJ2NvZGUnXSk+IC0xKSB7CiAgICAgICAgICBpZih0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4ID4gLTEgJiYgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICB0aGlzLmFycm93SXRlbShldmVudFsnY29kZSddLCB0aGlzLmVkcmF3Q29tcG9uZW50c1t0aGlzLmVTdGF0ZXMuY3VycmVudEFjdGl2ZUluZGV4XSkKICAgICAgICAgIH1lbHNlIGlmKHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5sZW5ndGggPiAwKXsKICAgICAgICAgICAgbGV0IGxlbiA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5sZW5ndGg7CiAgICAgICAgICAgIGZvcihsZXQgaT0wO2k8bGVuO2krKyl7CiAgICAgICAgICAgICAgIHRoaXMuYXJyb3dJdGVtKGV2ZW50Wydjb2RlJ10sIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXSkKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZihldmVudC5rZXkgPT09ICdEZWxldGUnIHx8IHRoaXMuaXNNYWMoKSAmJiBldmVudC5rZXkgPT09ICdCYWNrc3BhY2UnKSAgewogICAgICAgIHRoaXMuZGVsQ29tcCgpOwogICAgICB9CiAgICB9LAogICAgYXJyb3dJdGVtKGFycm93LCBvYmopIHsKICAgICAgaWYoYXJyb3cgJiYgb2JqKSB7CiAgICAgICAgc3dpdGNoIChhcnJvdykgewogICAgICAgICAgY2FzZSAnQXJyb3dVcCcgOgogICAgICAgICAgICBvYmouc3R5bGUudG9wID0gKG9iai5zdHlsZS50b3AgLSAxKSA+IDAgPyAoIG9iai5zdHlsZS50b3AgLSAxKSA6IDA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnQXJyb3dEb3duJyA6CiAgICAgICAgICAgIG9iai5zdHlsZS50b3AgPSBvYmouc3R5bGUudG9wICsgMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdBcnJvd0xlZnQnIDoKICAgICAgICAgICAgb2JqLnN0eWxlLmxlZnQgPSAob2JqLnN0eWxlLmxlZnQgLTEgKT4gMD8gKG9iai5zdHlsZS5sZWZ0IC0xKSA6IDA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6CiAgICAgICAgICAgIG9iai5zdHlsZS5sZWZ0ID0gIG9iai5zdHlsZS5sZWZ0ICsxOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWkmumAieS6i+S7tgogICAgbW91c2Vkb3duRnVuKGV2ZW50KSB7CiAgICAgIGlmKCghZXZlbnQuY3RybEtleSB8fCAhZXZlbnQubWV0YUtleSAmJiB0aGlzLmlzTWFjKCkpICYmIGV2ZW50LmJ1dHRvbiA9PT0gMCAKICAgICAgICAmJiBldmVudC50YXJnZXQuaWQ9PT0nY2FudmFzJyAKICAgICAgICAmJiAhZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29tcC1lbGVtZW50JykpIHsKICAgICAgICB0aGlzLmVTdGF0ZXMuY29weUJ5S2V5Qm9vbCA9IGZhbHNlOwogICAgICAgIHRoaXMuaW5pdENvbXBTdGF0ZSgpOwogICAgICB9IAogICAgfSwKICAgIC8vIOWIm+W7uuW9k+WJjee7hOS7tgogICAgY29weUN1cnJlbnRDb21wOmZ1bmN0aW9uKCkgewogICAgICBsZXQgX2N1cnJDb21wID0gdGhpcy5lZHJhd0NvbXBvbmVudHNbdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleF07CiAgICAgIGlmKCFfY3VyckNvbXApIHJldHVybjsKICAgICAgX2N1cnJDb21wLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgIGxldCBfY29weSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX2N1cnJDb21wKSk7CiAgICAgIGxldCBfc3R5bGUgPSBfY3VyckNvbXAuc3R5bGU7CiAgICAgIF9jb3B5LnN0eWxlLnRvcCA9IF9zdHlsZS5oZWlnaHQgKyBfc3R5bGUudG9wICsgMTsKICAgICAgX2NvcHkuaXNBY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLmVkcmF3Q29tcG9uZW50cy5wdXNoKF9jb3B5KTsKICAgICAgdGhpcy5lU3RhdGVzLmN1cnJlbnRBY3RpdmVJbmRleCA9IHRoaXMuZWRyYXdDb21wb25lbnRzLmxlbmd0aCAtIDE7IC8v5pu05paw5r+A5rS757uE5Lu255qE5LiL5qCHCiAgICB9LAogICAgLy8g5aSa6YCJ5pON5L2cOuWPjemAiS/muIXnqbrlpJrpgIkv5bGe5oCn5bqU55SoCiAgICBzZXRNdWx0aXBsZVN0YXRlOmZ1bmN0aW9uKHN0YXRlLCB2YWx1ZSkgewogICAgICBpZihzdGF0ZSA9PT0gJ0lzb21ldHJpYycpIHsKICAgICAgICBmb3IobGV0IGkgPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIubGVuZ3RoLTE7aT49MDtpLS0pIHsKICAgICAgICAgIGxldCBvYmogPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbaV07CiAgICAgICAgICBsZXQgYm9vbCA9IG9ialsnbXVsdGlwbGVBY3RpdmVCb29sJ107CiAgICAgICAgICBpZighYm9vbCkgewogICAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIuc3BsaWNlKGksMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxldCBsZW4gPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIubGVuZ3RoOwogICAgICAgIGxldCB2YWwgPSAwOwogICAgICAgIGlmKHZhbHVlID09PSAncm93JykgewogICAgICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyID0gIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyci5zb3J0KGZ1bmN0aW9uKGEsYil7CiAgICAgICAgICAgIHJldHVybiBhLnN0eWxlLmxlZnQgLSBiLnN0eWxlLmxlZnQ7CiAgICAgICAgICB9KQogICAgICAgICAgZm9yKGxldCBpPTA7aTwgbGVuO2krKykgewogICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXTsKICAgICAgICAgICAgaWYoaT4wKSB7CiAgICAgICAgICAgICAgaXRlbS5zdHlsZS5sZWZ0ID0gdmFsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhbCA9IGl0ZW0uc3R5bGUubGVmdCArIGl0ZW0uc3R5bGUud2lkdGggKyBwYXJzZUludCh0aGlzLmNvbmZpZ3MuSXNvbWV0cmljX3Jvdyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9ICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIuc29ydChmdW5jdGlvbihhLGIpewogICAgICAgICAgICByZXR1cm4gYS5zdHlsZS50b3AgLSBiLnN0eWxlLnRvcCA7CiAgICAgICAgICB9KQogICAgICAgICAgZm9yKGxldCBpPTA7aTwgbGVuO2krKykgewogICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXTsKICAgICAgICAgICAgaWYoaT4wKSB7CiAgICAgICAgICAgICAgaXRlbS5zdHlsZS50b3AgPSB2YWw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFsID0gaXRlbS5zdHlsZS5oZWlnaHQgKyBpdGVtLnN0eWxlLnRvcCArIHBhcnNlSW50KHRoaXMuY29uZmlncy5Jc29tZXRyaWNfY29sdSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGksICB0aGlzLmNvbmZpZ3MuSXNvbWV0cmljX2NvbHUsIHZhbCkKICAgICAgICAgIH0KICAgICAgICB9ICAgICAKICAgICAgfWVsc2UgaWYoc3RhdGUgPT09ICdyZVNlbCcpIHsKICAgICAgICBsZXQgbGVuID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwogICAgICAgIGZvcihsZXQgaT1sZW47aS0tO2kgPjApIHsKICAgICAgICAgIGxldCBpdGVtID0gdGhpcy5lZHJhd0NvbXBvbmVudHNbaV07CiAgICAgICAgICBpZighaXRlbS5tdWx0aXBsZUFjdGl2ZUJvb2wpIHsgIAogICAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIucHVzaChpdGVtKTsKICAgICAgICAgIH0KICAgICAgICAgIGl0ZW0ubXVsdGlwbGVBY3RpdmVCb29sID0gIWl0ZW0ubXVsdGlwbGVBY3RpdmVCb29sOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmKHN0YXRlID09PSAnY2xlYXInKXsKICAgICAgICBsZXQgbGVuID0gdGhpcy5lZHJhd0NvbXBvbmVudHMubGVuZ3RoOwogICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFyciA9IFtdOwogICAgICAgIGZvcihsZXQgaT1sZW47aS0tO2kgPjApIHsKICAgICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW2ldLm11bHRpcGxlQWN0aXZlQm9vbCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfWVsc2UgaWYoWydpc0FwcGx5U2hhZG93JywgJ2JvcmRlclJhZGl1cyddLmluZGV4T2Yoc3RhdGUpID4gLTEpIHsKICAgICAgICBsZXQgbGVuID0gdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLmxlbmd0aDsKICAgICAgICBmb3IobGV0IGk9bGVuO2ktLTtpID4wKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbaV0uc3R5bGVbc3RhdGVdID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9ZWxzZSBpZihzdGF0ZSA9PT0gJ2FsaWduJykgewogICAgICAgIHN3aXRjaCh2YWx1ZSkgewogICAgICAgICAgY2FzZSAndCcgOgogICAgICAgICAgICB0aGlzLm11bHRpcEFycmF5KCd0b3AnKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdsJyA6CiAgICAgICAgICAgIHRoaXMubXVsdGlwQXJyYXkoJ2xlZnQnKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdiJyA6CiAgICAgICAgICAgIHRoaXMubXVsdGlwQXJyYXkoJ2JvdHRvbScpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ3InIDoKICAgICAgICAgICAgdGhpcy5tdWx0aXBBcnJheSgncmlnaHQnKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyDliKDpmaTlpJrpgInlhYPntKAKICAgIGRlbE11bHRpcENvbXAoY29tcCwgaW5kZXgpIHsKICAgICAgdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyLnNwbGljZShpbmRleCwgMSk7CiAgICAgIGxldCBfaW5kZXggPSB0aGlzLmVkcmF3Q29tcG9uZW50cy5pbmRleE9mKGNvbXApOwogICAgICBpZihfaW5kZXggPiAtMSkgewogICAgICAgIHRoaXMuZWRyYXdDb21wb25lbnRzW19pbmRleF0ubXVsdGlwbGVBY3RpdmVCb29sID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VDb25maWcoc3RhdGUsIHZhbHVlKXsKICAgICAgaWYoIXRoaXMuY29uZmlnc1tzdGF0ZV0pIHJldHVybjsKICAgICAgdGhpcy5jb25maWdzW3N0YXRlXSA9IHZhbHVlOwogICAgfSwKICAgIG11bHRpcEFycmF5KHBhcmFtKSB7CiAgICAgIGxldCBsaXN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIpKTsKICAgICAgbGlzdC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICByZXR1cm4gWyd0b3AnLCAnbGVmdCddLmluZGV4T2YocGFyYW0pID4gLTEgPyBhLnN0eWxlW3BhcmFtXSAtIGIuc3R5bGVbcGFyYW1dOgogICAgICAgICAgcGFyYW0gPT09ICdib3R0b20nID8gIGIuc3R5bGUudG9wICsgYi5zdHlsZS5oZWlnaHQgLSAoYS5zdHlsZS50b3AgKyBhLnN0eWxlLmhlaWdodCkgOgogICAgICAgICAgYi5zdHlsZS5sZWZ0ICsgYi5zdHlsZS53aWR0aCAtIChhLnN0eWxlLmxlZnQgKyBhLnN0eWxlLndpZHRoKSAKICAgICAgfSk7CiAgICAgIGxldCBsZW4gPSB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnIubGVuZ3RoOwogICAgICBsZXQgcmVzT2JqID0gbGlzdFswXTsKICAgICAgaWYoWyd0b3AnLCAnbGVmdCddLmluZGV4T2YocGFyYW0pID4gLTEpIHsKICAgICAgICBmb3IobGV0IGk9MDtpPGxlbjtpKyspIHsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXS5zdHlsZVtwYXJhbV0gPSByZXNPYmouc3R5bGVbcGFyYW1dOwogICAgICAgIH0KICAgICAgfWVsc2UgaWYocGFyYW0gPT09ICdib3R0b20nKSB7CiAgICAgICAgbGV0IF9ib3R0b20gPSByZXNPYmouc3R5bGUudG9wICsgcmVzT2JqLnN0eWxlLmhlaWdodDsKICAgICAgICBmb3IobGV0IGk9MDtpPGxlbjtpKyspIHsKICAgICAgICAgIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXS5zdHlsZS50b3AgPSBfYm90dG9tIC0gdGhpcy5lU3RhdGVzLm11bHRpcGxlQWN0aXZlQXJyW2ldLnN0eWxlLmhlaWdodDsKICAgICAgICB9CiAgICAgIH1lbHNlIGlmKHBhcmFtID09PSAncmlnaHQnKSB7CiAgICAgICAgY29uc29sZS5sb2cocGFyYW0sIHJlc09iaikKICAgICAgICBsZXQgX3JpZ2h0ID0gcmVzT2JqLnN0eWxlLmxlZnQgKyByZXNPYmouc3R5bGUud2lkdGg7CiAgICAgICAgZm9yKGxldCBpPTA7aTxsZW47aSsrKSB7CiAgICAgICAgICB0aGlzLmVTdGF0ZXMubXVsdGlwbGVBY3RpdmVBcnJbaV0uc3R5bGUubGVmdCA9IF9yaWdodCAtIHRoaXMuZVN0YXRlcy5tdWx0aXBsZUFjdGl2ZUFycltpXS5zdHlsZS53aWR0aDsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBpc01hYzpmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIC9tYWNpbnRvc2h8bWFjIG9zIHgvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpCiAgICB9LAogICAgc2NyZWVuOmZ1bmN0aW9uKCkgewogICAgICB0aGlzLmNvbmZpZ3MuYmdBbGxCb29sID0gIXRoaXMuY29uZmlncy5iZ0FsbEJvb2w7CiAgICAgIGlmKHRoaXMuY29uZmlncy5iZ0FsbEJvb2wpIHsKICAgICAgICB0aGlzLmNvbmZpZ3Mud2luZG93X3cgPSB3aW5kb3cuc2NyZWVuLndpZHRoID4gMTUwMCA/IHdpbmRvdy5zY3JlZW4ud2lkdGggOiAxNTAwOwogICAgICAgIHRoaXMuY29uZmlncy53aW5kb3dfaCA9IHdpbmRvdy5zY3JlZW4uaGVpZ2h0ID4gODAwID8gd2luZG93LnNjcmVlbi5oZWlnaHQgOiA4MDA7CiAgICAgICAgdGhpcy5jb25maWdzLnNjYWxlID0gMTsKICAgICAgfQoKICAgIH0KICB9Cn0K"},{"version":3,"sources":["editor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"editor.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"editor\">\n    <editor-comps \n      v-bind:elements=\"edrawComponents\"\n      v-on:initCompsState=\"initComponentState\" \n      v-on:selectComp=\"selectComp\"></editor-comps>\n    <editor-canvas \n      v-bind:configs=\"configs\"\n      v-bind:edrawComps=\"edrawComponents\"\n      v-bind:currentActiveIndex=\"eStates.currentActiveIndex\"\n      v-bind:multipleActiveBool=\"eStates.multipleActiveBool\"\n      v-on:initCompsState=\"initComponentState\" \n      v-on:dragComp=\"dragCurrentComp\"\n      v-on:screen=\"screen\"></editor-canvas>\n    <editor-settings\n      v-bind:currentActiveIndex=\"eStates.currentActiveIndex\"\n      v-bind:currentElement=\"edrawComponents[eStates.currentActiveIndex]\"\n      v-bind:multipleActiveArr=\"eStates.multipleActiveArr\"\n      v-bind:configs=\"configs\"\n      v-on:delComp=\"delComp\"\n      v-on:delMultipComp=\"delMultipComp\"\n      v-on:setMultipleState=\"setMultipleState\"\n      v-on:changeConfig=\"changeConfig\"\n      v-on:download=\"download\"\n      v-on:screen=\"screen\"></editor-settings>\n    <editor-help>\n\n    </editor-help>\n  </div>\n</template>\n\n<script>\nimport EditorComps from './editor-comps';\nimport EditorCanvas from './editor-canvas';\nimport EditorSettings from './editor-settings';\nimport EditorHelp from './editor-help'\nimport html2canvas from 'html2canvas';\n\nexport default {\n  name: 'Editor',\n  created:function() {\n    document.addEventListener('keydown', this.kaydownFun);\n    document.addEventListener('mousedown', this.mousedownFun)\n  },\n  data(){\n     return {\n        eStates:{\n          currentActiveIndex:-1,\n          copyByKeyBool:false,\n          multipleActiveArr:[],\n        },\n        edrawComponents:[],\n        configs:{\n          bg:\"grid\",\n          pageName:'底图',\n          spacing:10,\n          scale:1,\n          Isometric_row:10,\n          Isometric_colu:10,\n          dowloadImgType:'png',\n          bgAllBool:false,\n          window_w:1920,\n          window_h:900\n        }\n     }\n  },\n  components: {\n    'editor-comps':EditorComps,\n    'editor-canvas':EditorCanvas,\n    'editor-settings':EditorSettings,\n    'editor-help':EditorHelp\n  },\n  methods: {\n    download:function() {\n      html2canvas(document.getElementById('canvas'),{\n        letterRendering: true, allowTaint: false, useCORS: true, \n        scale: 1920*2/window.innerWidth, \n        backgroundColor: 'red' \n      }).then(canvas => {\n        this.saveAs( canvas.toDataURL('image/png'))\n      }).catch((error) => {\n        console.log(\"ERROR SAVING FESTIVAL IMAGE\", error)\n      });\n    },\n    saveAs:function(img) {\n      let _dom = window.document.createElement('a');\n        _dom.href = img\n        _dom.dataset.downloadurl = ['image/png', 'IMG_DOWNLOAD_NAME', _dom.href].join(':');\n        document.body.appendChild(_dom);\n        _dom.click();\n        document.body.removeChild(_dom);\n    },\n    // 组件选择\n    selectComp(event, comp) {\n      let item = JSON.parse(JSON.stringify(comp));\n      if(!item) return;\n      this.initCompState();\n      item.isActive = true;\n      item.multipleActiveBool=false;\n      let {width, height, borderRadius} = item.defStyle;\n      let {clientX , clientY} = event;\n      let _style = {\n          width:width || 100,\n          height:height || 100,\n          top: clientY ||100,\n          left:clientX || 100,\n          drag_start_x: 0, //拖拽相对\n          drag_start_y :0,\n          position:'absolute',\n          isApplyShadow:'true',\n          borderRadius:borderRadius || 0\n      }\n      item.style = _style;\n      this.edrawComponents.push(item);\n      this.eStates.currentActiveIndex = this.edrawComponents.length -1;\n    },\n    initComponentState(current, event) {\n      if(current === undefined || current === null || current === -1) return;\n      if(event && (event.ctrlKey || event.metaKey && this.isMac()) && event.button === 0 ) {\n        this.edrawComponents[current].isActive = false;\n        if(this.eStates.currentActiveIndex > -1) {\n          this.eStates.currentActiveIndex = -1;\n        }\n\n        // 多选操作缓存数组\n        const _multipActiveIndex = this.eStates.multipleActiveArr.indexOf(this.edrawComponents[current]);\n        if( _multipActiveIndex === -1) {\n          this.eStates.multipleActiveArr.push(this.edrawComponents[current])\n        }\n\n        if(this.edrawComponents[current].multipleActiveBool) {\n          this.edrawComponents[current].multipleActiveBool = false;\n          this.eStates.multipleActiveArr.splice(_multipActiveIndex, 1);\n        } else {\n          this.edrawComponents[current].multipleActiveBool = true;\n        }\n      }else {\n        this.initCompState();     \n        this.eStates.currentActiveIndex = current;\n        this.edrawComponents[current].isActive = true;\n      }\n\n    },\n    // 初始化画布内组件状态\n    initCompState() {\n      let len = this.edrawComponents.length;\n      this.eStates.multipleActiveArr = [];\n      for(let i=0;i<len;i++) {\n        this.edrawComponents[i].isActive = false;\n        this.edrawComponents[i].multipleActiveBool = false;\n      }\n      this.eStates.copyByKeyBool = false;\n    },\n    // 组件拖拽：ctrlkey === true 处理多选\n    dragCurrentComp(event, comp, state, currentIndex, canvesRect) {\n      if(event && (event.ctrlKey || event.metaKey && this.isMac())  ){\n        console.log('多选处理')\n      } else {\n        this.initCompState();\n        this.eStates.copyByKeyBool = false;\n        if(state === 'start') {\n          this.eStates.currentActiveIndex = currentIndex;\n          comp.style.drag_start_x = event.clientX - comp.style.left;\n          comp.style.drag_start_y = event.clientY - comp.style.top;\n        }else if(state === 'drag'){\n          let _left = event.clientX - comp.style.drag_start_x; \n          let _top = event.clientY - comp.style.drag_start_y;\n          if(_left <0 || _top < 0) return;\n          let left = (_left - canvesRect.x) >= 0 ? _left : canvesRect.x; // 处理left编辑问题\n          let top = (_top - canvesRect.y) >= 0 ? _top : canvesRect.y; // 处理top边界问题\n          comp.style.left = left;\n          comp.style.top = top;\n        }\n      }\n    },\n    // 组件删除\n    delComp(index, state) {\n      if(state === 'multipleDel') {\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          let multipBool = this.edrawComponents[i].multipleActiveBool;\n          if(multipBool) {\n            this.edrawComponents.splice(i,1)\n          }\n        }\n      } else {\n        if(this.eStates.currentActiveIndex > -1 &&this.edrawComponents.length > 0) {\n          this.edrawComponents.splice(this.eStates.currentActiveIndex,1)\n          this.eStates.currentActiveIndex = -1;\n        }\n      }\n    },\n    // 键盘事件\n    kaydownFun(event) {\n      if(event.key === 'c') {\n        this.eStates.copyByKeyBool = true;\n      }else if(this.eStates.copyByKeyBool && event.key === 'v') {\n        this.copyCurrentComp();\n      }else {\n        if(['ArrowUp','ArrowDown','ArrowLeft',\"ArrowRight\"].indexOf(event['code'])> -1) {\n          if(this.eStates.currentActiveIndex > -1 && this.eStates.multipleActiveArr.length === 0) {\n            this.arrowItem(event['code'], this.edrawComponents[this.eStates.currentActiveIndex])\n          }else if(this.eStates.multipleActiveArr.length > 0){\n            let len = this.eStates.multipleActiveArr.length;\n            for(let i=0;i<len;i++){\n               this.arrowItem(event['code'], this.eStates.multipleActiveArr[i])\n            }\n          }\n        }\n      }\n      if(event.key === 'Delete' || this.isMac() && event.key === 'Backspace')  {\n        this.delComp();\n      }\n    },\n    arrowItem(arrow, obj) {\n      if(arrow && obj) {\n        switch (arrow) {\n          case 'ArrowUp' :\n            obj.style.top = (obj.style.top - 1) > 0 ? ( obj.style.top - 1) : 0;\n            break;\n          case 'ArrowDown' :\n            obj.style.top = obj.style.top + 1;\n            break;\n          case 'ArrowLeft' :\n            obj.style.left = (obj.style.left -1 )> 0? (obj.style.left -1) : 0;\n            break;\n          case 'ArrowRight':\n            obj.style.left =  obj.style.left +1;\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    // 多选事件\n    mousedownFun(event) {\n      if((!event.ctrlKey || !event.metaKey && this.isMac()) && event.button === 0 \n        && event.target.id==='canvas' \n        && !event.target.classList.contains('comp-element')) {\n        this.eStates.copyByKeyBool = false;\n        this.initCompState();\n      } \n    },\n    // 创建当前组件\n    copyCurrentComp:function() {\n      let _currComp = this.edrawComponents[this.eStates.currentActiveIndex];\n      if(!_currComp) return;\n      _currComp.isActive = false;\n      let _copy = JSON.parse(JSON.stringify(_currComp));\n      let _style = _currComp.style;\n      _copy.style.top = _style.height + _style.top + 1;\n      _copy.isActive = true;\n      this.edrawComponents.push(_copy);\n      this.eStates.currentActiveIndex = this.edrawComponents.length - 1; //更新激活组件的下标\n    },\n    // 多选操作:反选/清空多选/属性应用\n    setMultipleState:function(state, value) {\n      if(state === 'Isometric') {\n        for(let i = this.eStates.multipleActiveArr.length-1;i>=0;i--) {\n          let obj = this.eStates.multipleActiveArr[i];\n          let bool = obj['multipleActiveBool'];\n          if(!bool) {\n            this.eStates.multipleActiveArr.splice(i,1);\n          }\n        }\n        let len = this.eStates.multipleActiveArr.length;\n        let val = 0;\n        if(value === 'row') {\n          this.eStates.multipleActiveArr =  this.eStates.multipleActiveArr.sort(function(a,b){\n            return a.style.left - b.style.left;\n          })\n          for(let i=0;i< len;i++) {\n            let item = this.eStates.multipleActiveArr[i];\n            if(i>0) {\n              item.style.left = val;\n            }\n            val = item.style.left + item.style.width + parseInt(this.configs.Isometric_row);\n          }\n        } else {\n          this.eStates.multipleActiveArr =  this.eStates.multipleActiveArr.sort(function(a,b){\n            return a.style.top - b.style.top ;\n          })\n          for(let i=0;i< len;i++) {\n            let item = this.eStates.multipleActiveArr[i];\n            if(i>0) {\n              item.style.top = val;\n            }\n            val = item.style.height + item.style.top + parseInt(this.configs.Isometric_colu);\n            console.log(i,  this.configs.Isometric_colu, val)\n          }\n        }     \n      }else if(state === 'reSel') {\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          let item = this.edrawComponents[i];\n          if(!item.multipleActiveBool) {  \n            this.eStates.multipleActiveArr.push(item);\n          }\n          item.multipleActiveBool = !item.multipleActiveBool;\n        }\n      } else if(state === 'clear'){\n        let len = this.edrawComponents.length;\n        this.eStates.multipleActiveArr = [];\n        for(let i=len;i--;i >0) {\n          this.edrawComponents[i].multipleActiveBool = false;\n        }\n      }else if(['isApplyShadow', 'borderRadius'].indexOf(state) > -1) {\n        let len = this.eStates.multipleActiveArr.length;\n        for(let i=len;i--;i >0) {\n          this.eStates.multipleActiveArr[i].style[state] = value;\n        }\n      }else if(state === 'align') {\n        switch(value) {\n          case 't' :\n            this.multipArray('top');\n            break;\n          case 'l' :\n            this.multipArray('left');\n            break;\n          case 'b' :\n            this.multipArray('bottom');\n            break;\n          case 'r' :\n            this.multipArray('right');\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    // 删除多选元素\n    delMultipComp(comp, index) {\n      this.eStates.multipleActiveArr.splice(index, 1);\n      let _index = this.edrawComponents.indexOf(comp);\n      if(_index > -1) {\n        this.edrawComponents[_index].multipleActiveBool = false;\n      }\n    },\n    changeConfig(state, value){\n      if(!this.configs[state]) return;\n      this.configs[state] = value;\n    },\n    multipArray(param) {\n      let list = JSON.parse(JSON.stringify(this.eStates.multipleActiveArr));\n      list.sort(function(a, b) {\n        return ['top', 'left'].indexOf(param) > -1 ? a.style[param] - b.style[param]:\n          param === 'bottom' ?  b.style.top + b.style.height - (a.style.top + a.style.height) :\n          b.style.left + b.style.width - (a.style.left + a.style.width) \n      });\n      let len = this.eStates.multipleActiveArr.length;\n      let resObj = list[0];\n      if(['top', 'left'].indexOf(param) > -1) {\n        for(let i=0;i<len;i++) {\n          this.eStates.multipleActiveArr[i].style[param] = resObj.style[param];\n        }\n      }else if(param === 'bottom') {\n        let _bottom = resObj.style.top + resObj.style.height;\n        for(let i=0;i<len;i++) {\n          this.eStates.multipleActiveArr[i].style.top = _bottom - this.eStates.multipleActiveArr[i].style.height;\n        }\n      }else if(param === 'right') {\n        console.log(param, resObj)\n        let _right = resObj.style.left + resObj.style.width;\n        for(let i=0;i<len;i++) {\n          this.eStates.multipleActiveArr[i].style.left = _right - this.eStates.multipleActiveArr[i].style.width;\n        }\n      }\n    },\n    isMac:function() {\n      return /macintosh|mac os x/i.test(navigator.userAgent)\n    },\n    screen:function() {\n      this.configs.bgAllBool = !this.configs.bgAllBool;\n      if(this.configs.bgAllBool) {\n        this.configs.window_w = window.screen.width > 1500 ? window.screen.width : 1500;\n        this.configs.window_h = window.screen.height > 800 ? window.screen.height : 800;\n        this.configs.scale = 1;\n      }\n\n    }\n  }\n}\n</script>\n\n<style>\n\n#editor {\n  margin-top: 60px;\n  padding: 0;\n  position: relative;\n  color: #2c3e50;\n  display: grid;\n  grid-template-columns: 205px auto 205px;\n}\n</style>\n"]}]}